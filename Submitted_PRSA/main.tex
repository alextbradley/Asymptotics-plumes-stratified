%% Author_tex.tex
%% V1.0
%% 2012/13/12
%% developed by Techset
%%
%% This file describes the coding for rsproca.cls

\documentclass[openacc]{rsproca_new}%%%%where rsproca is the template name

%%%% *** Do not adjust lengths that control margins, column widths, etc. ***

%%%%%%%%%%% Defining Enunciations  %%%%%%%%%%%
\newtheorem{theorem}{\bf Theorem}[section]
\newtheorem{condition}{\bf Condition}[section]
\newtheorem{corollary}{\bf Corollary}[section]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{graphicx}
\usepackage{epstopdf, epsfig}
\usepackage{newtxtext}
\usepackage{newtxmath}
\usepackage{hyperref}
\usepackage{color}
\usepackage{siunitx}
\usepackage[square, numbers]{natbib}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%colors, derivatives
\newcommand{\dd}[2]{\frac{\mathrm{d} #1}{\mathrm{d} #2}}
\newcommand{\ddp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\order}[1]{\mathcal{O}(#1)}
\newcommand{\red}[1]{{\color{red} #1}}
\newcommand{\blue}[1]{{\color{blue} #1}}
\newcommand{\cyan}[1]{{\color{cyan} #1}}

%dimensionless parameters
\newcommand{\epsone}{\epsilon_{1}} %eps1 = E0 alpha/ Cd
\newcommand{\epstwo}{\epsilon_{2}} %eps2 = E0 alpha/St
\newcommand{\epsthree}{\epsilon_{3}} %eps3 = tau/(L/c)
\newcommand{\epsfour}{\epsilon_{4}} 
\newcommand{\epsfive}{\epsilon_{5}} %eps_5 = E0/2
\newcommand{\epssix}{\epsilon_{6}} %eps_5 = E0/2
\newcommand{\Pb}{\textit{P}_B}  %\frac{L/c}{ \tau}\frac{S_l - S_u}{2S_l},
\newcommand{\lt}{\delta} %dimensionless thermocline length, lt/l0
\newcommand{\Pt}{\textit{P}_T}

%pycnocline region constants
\newcommand{\cone}{c_1}  %c1 = eps1 / delta ~ O(1)
\newcommand{\ctwo}{c_2}  %c2 = eps2 / delta ~ O(1)
\renewcommand{\in}{\text{in}} %subcript on into and out of pycnocline variables
\newcommand{\out}{\text{out}}


\newcommand\abcdeqn[2]{\refstepcounter{equation}
     \[
     \label{#1}
     #2
     \eqno{\text{(\theequation)}\text{a,b,c,d}}
     \]
}

\newcommand\abeqn[2]{\refstepcounter{equation}
     \[
     \label{#1}
     #2
     \eqno{\text{(\theequation)}\text{a,b}}
     \]
}

\begin{document}

%%%% Article title to be placed here
\title{Asymptotic Analysis of Subglacial Plumes in Stratified Environments}

\author{%%%% Author details
Alexander T Bradley$^{1}$, C. Rosie Williams$^{1}$, Adrian Jenkins$^{2}$ and Robert Arthern$^{1}$}

%%%%%%%%% Insert author address here
\address{$^{1}$British Antarctic Survey, High Cross, Madingley Road, Cambridge CB3 0ET, UK\\
$^{2}$Department of Geography and Environmental Sciences, Northumbria University, Newcastle upon Tyne, UK.}

%%%% Subject entries to be placed here %%%%
\subject{xxxxx, xxxxx, xxxx}

%%%% Keyword entries to be placed here %%%%
\keywords{xxxx, xxxx, xxxx}

%%%% Insert corresponding author and its email address}
\corres{Alexander T Bradley\\
\email{aleey@bas.ac.uk}}

%%%% Abstract text to be placed here %%%%%%%%%%%%
\begin{abstract}
Accurate predictions of basal melt rates on ice shelves are necessary for precise projections of the future behaviour of ice sheets. The computational expense associated with completely resolving the cavity circulation using an ocean model makes this approach unfeasible for multi-century simulations, and parametrizations of melt rates are required. At present, some of the most advanced melt rate parametrizations are based on a one-dimensional approximation to the melt rate that emerges from the theory of subglacial plumes applied to ice shelves with constant basal slopes and uniform ambient ocean conditions; in this work, we present an asymptotic analysis of the corresponding equations in which non-constant basal slopes and typical ambient conditions are imposed. This analysis exploits the small aspect ratio of ice shelf bases, the relatively weak thermal driving and the relative slenderness of the pycnocline in the ambient ocean. We construct an approximation to the melt rate that is based on this analysis, which shows good agreement with numerical solutions in a wide variety of cases, suggesting a path towards improved predictions of basal melt rates in ice-sheet models.
\end{abstract}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%% Insert the texts which can accomdate on firstpage in the tag "fmtext" %%%%%

\begin{fmtext}

\end{fmtext}
\maketitle
\section{Introduction}\label{S:Introduction}
The Antarctic ice sheet has undergone significant change in recent years, characterized by significant thinning, mass loss and acceleration~\cite{Pritchard2012Nature, Mouginot2014GRL, Paolo2015Science, Rignot2019PNAS}. An increase in basal melting on ice shelves -- the floating extensions of the grounded ice that surround the sheet -- has been implicated in these changes~\cite{Shepherd2004GRL, Jenkins2010NatureGeo, Hellmer2012Nature}; increased basal melting reduces buttressing~\citep{Gagliardini2010GRL, Goldberg2019GRL} -- the resistive effect that ice shelves apply to the grounded ice upstream -- leading to an increase in the flux of ice from the grounded to floating regions of the ice sheet~\citep{Gudmundsson2013Cryo}, and increasing the possibility of ice sheet instabilities~\citep{Schoof2007JGeophysResEarth,Vaughan2007Science}. Changes in ice shelf buttressing and  the potential for ice sheet instabilities exert leading order controls on future projections of the Antarctic ice sheet and the associated sea level rise contributions~\citep{DeConto2016Nature, Arthern2017GRL}; accurate descriptions of the basal melt rate that results from ice-ocean interaction are therefore necessary to constrain predictions of sea level rise. 

Ice-shelf basal melting is often characterized by three main modes, whose relative importance depends on myriad factors including the geometry of the ice shelf cavity, the presence of circumpolar deep water on the continental shelf, and oceanic tides~\citep{Jacobs1992JGlac}. So-called `mode one' melting is driven by inflows of cold, dense shelf water which is produced by sea ice formation, and results in the formation of buoyant plumes of meltwater; `mode two' melting is driven by warm circumpolar deep water that spills over the continental shelf; and `mode three' is driven by surface waters~\citep{Silvano2016Oceanography}. Mode one melting makes up the dominant contribution to melting in Antarctica~\citep{Adusumilli2020NatureGeo}.

Ocean general circulation models aim to account for each of these modes of melting by explicitly resolving the circulation within the cavity. These models require high resolution in both the horizontal and vertical directions if they are to accurately resolve important processes such as mesoscale eddies~\citep{Stewart2015GRL}, flow-topography interactions~\citep{Nakayama2014OceanModelling}, shelf-break jets~\citep{Graham2016JGeophysResOceans} and, crucially, the turbulent entrainment inside a boundary layer next to the ice~\citep{Kimura2014JPhysOcean, Xu2012AnnGlac}. As a result, they are computationally expensive, especially when coupled to a dynamic ice sheet model whose geometry evolves over time; fully-coupled simulations of ice-ocean interactions are, to date, limited in their spatial extent to single ice shelf cavities~\citep[e.g.][]{DeRydt2016JGeophysResEarthSurf, Seroussi2017GRL} or in their temporal extent if multiple cavities are included~\citep[e.g.][]{Mathiot2017GeosciModDev,Naughten2018JClim}.

An alternative approach is required for longer (multi-century) simulations of ice sheets. All multi-century simulations of the Antarctic ice sheets to date have applied an analytic approximation (a parametrization) to the basal melt rate. Many different parametrizations have been proposed, but typically fall into one (or more) of the following four categories: constant melt rates applied everywhere~\citep[e.g.][]{Arthern2017GRL}; parametrizations including simple ice draft depth dependence~\citep[e.g.][]{Joughin2014Science}; parametrizations based on a local balance of heat at the ice ocean interface~\citep[e.g][]{Golledge2015Nature}; and parametrizations including with a linear~\citep[e.g.][]{Favier2016Cryo} or quadratic dependence~\citep[e.g.][]{Holland2008JClimate,DeConto2016Nature} on ocean temperature.

In recent years, however, two novel melt rate parametrizations have emerged, which cannot be categorized in this way. The first from~\cite{Reese2018Cryo} is based on a one-dimensional ocean-box model that coarsely resolves ice shelf cavities. The second is a `plume emulator' from~\cite{Lazeroms2018TheCryo}, the name arising from it's based in the theory of subglacial plumes. Both of these conceptualize the circulation in the whole cavity, a feature that is lacking in the simpler parametrizations mentioned above. In this paper, we focus on the plume emulator parametrization, which reproduces melt patterns across Antarctica that are qualitatively similar to observations~\citep{Lazeroms2018TheCryo} and performs reasonably well when compared to a fully coupled ice-ocean model~\citep{Favier2019GeosciModDev}.

The theory of subglacial plumes was pioneered by~\citet{MacAyeal1985} and~\citet{Jenkins1991JGeophysResOceans}, studies which themselves build upon the classical theories of plumes and gravity currents~\citep{Ellison1959JFM, Morton1956PRSL, Turner1979}. Subglacial plumes are buoyancy driven flows that form when ice melts into the ocean or is discharged at the grounding line; in both of these cases, the water released is fresher than the ambient ocean, providing a source of buoyancy that drives a turbulent flow upwards along ice shelf base. The turbulent motion within the plume results in entrainment of relatively warm and salty ambient water; on the one hand, the associated increase in temperature of the plume promotes enhanced melting of the ice shelf base, further freshening the plume (ocean temperatures in Antarctica are typically within a few degrees of the local freezing point, so density variations are controlled primarily by salinity~\citep{Hewitt2020AnnRevFlu}). On the other hand, the increase in salinity of the plume that results from ambient entrainment reduces its buoyancy deficit relative to the ambient ocean, retarding its motion up the ice shelf base. This interplay between melting, ambient entrainment, and subglacial discharge leads to complex dynamics, which are further influenced by the variation of the pressure-dependent freezing temperature with depth. 

There are four important length scales involved in the dynamics of subglacial plumes. The first is related to stratification of the ambient ocean: subglacial plumes entrain relatively salty (and thus dense) ambient water at depth, which is carried upwards to regions of lower ambient density.  where it may ultimately become negatively buoyant; the depth at which this transition to negative buoyancy occurs prescribes a length scale associated with ambient stratification~\citep{Magorrian2016JGeoResOcean}. The second length scale is related to the variation of the freezing temperature with depth: as the plume rises, as does the in situ freezing point; the plume may become super-cooled, leading to refreezing of ice onto the shelf base (the so-called ice pump described by~\cite{Lewis1986JGeophysResOceans}). The distance over which the thermal driving (the difference between the plume temperature and the in situ freezing point) at the grounding line decays to zero as a result of this depth dependence on temperature gives the associated length scale~\citep{LaneSerff1995JGeophysResOceans}. The third length scale is associated with subglacial discharge. Far from the grounding line, mass inputs to the plume are dominated by ambient entrainment, but close to the grounding line, subglacial discharge remains important; the cross-over between these two regimes defines the length scale associated with subglacial discharge. This length scale depends sensitively on the input flux~\citep{Jenkins2011JPhysOcean}; ice shelves in Antarctica typically have a small subglacial discharge and this length scale is therefore very small, and the effect of subglacial discharge on plume dynamics can be neglected. The final length scale is the plume thickness at which rotation (Coriolis forces) begin to dominate the dynamics; in practice, this is when the plume thickness exceeds the Ekman length~\citep{Jenkins2011JPhysOcean}. As the plume thickness approaches the Ekman length, the concept of entrainment becomes increasing poorly defined and simple plume theory may be invalid.  Well-mixed conditions are likely to be maintained only within the Ekman layer, beyond which there will be a gradual transition to ambient properties through a broad pycnocline (Jenkins, in press).  In a stratified ambient, the distinction between ambient and plume will become unclear, and lower parts of the pycnocline will progressively detrain into the ambient.

The plume emulator parametrizations of~\cite{Lazeroms2018TheCryo} is based on an approximation to the melt rate that emerges from the system of equations governing subglacial plumes in one spatial dimension, extended to two spatial dimensions. Originally, this approximation was based on a polynomial fit to data that was obtained by numerically solving this system of equations~\citep{Jenkins2014scaling}, but an analytic expression was subsequently derived by~\cite{Lazeroms2019JPhysOcean}, via an asymptotic analysis of the system in the limit of weak thermal driving and shallow slopes of the ice shelf base. The system of equations on which both the fit to numerical data and the asymptotic analysis were based assumed that the ice shelf has a constant basal slope, as well as a constant temperature and salinity in the ambient ocean; in practice the ice shelf basal slope displays significant heterogeneity and the ambient ocean is highly stratified. The aim of this paper is to construct an approximation to the melt rate that emerges from a one-dimensional plume model which includes a typical ambient stratification and a non-constant ice shelf basal slope, with a view to ultimately improving upon the~\cite{Lazeroms2018TheCryo} melt rate parametrization by accounting for more realistic conditions.

The ambient stratification we consider here is based on typical conditions observed in the Amundsen Sea sector of Antarctica~\cite{Jenkins2018NatureGeo}. It consists of two fairly uniform layers separated by a pycnocline -- a relatively thin layer in which gradients in both temperature and salinity are strong. Below the pycnocline, the ambient ocean is warm and salty, deriving from modified circumpolar deep water, which spills over the continental shelf break. Above the pycnocline, the ambient ocean is cold and fresh, deriving from Winter Water which forms from cooling, brine drainage and convection beneath growing sea ice.

This paper is structured as follows: in \S\ref{S:Model}, we provide a brief outline of the mathematical model of subglacial plumes of~\cite{Jenkins1991JGeophysResOceans} and~\cite{Jenkins2011JPhysOcean}, in which ambient stratification and non-constant ice shelf basal slopes are included explicitly. This model is non-dimensionalized using scales that emerge from a similarity solution that is valid close to the grounding line. We then present example solutions of the equations governing this dimensionless model, which provide insight into the behaviour; in doing so, we informally introduce the different regions of the solution referred to in the asymptotic analysis that follows in \S\ref{S:Asymptotics}. This asymptotic analysis exploits the small size of several of the dimensionless parameters identified in the non-dimensionalization, including the aspect ratio of the ice shelf base, the weak thermal driving, and the relative slenderness of the pycnocline. The behaviour is different in each of the four regions, which emerge naturally from the analysis, and we analyze each of these regions in turn. Following this, in \S\ref{S:MeltRate}, we present details of our approximation to the melt rate, which draws on the asymptotic analysis presented in \S\ref{S:Asymptotics}. In \S\ref{S:Numerics}, we assess the performance of this approximation by comparing it with both numerical solutions of the model equations and the corresponding~\cite{Lazeroms2019JPhysOcean} approximation. Finally, in \S\ref{S:Discussion}, we summarize our results and provide concluding remarks. 


\section{Mathematical Model}\label{S:Model}

\begin{figure}
\centering
\includegraphics[width = \textwidth]{./figures/fig1_schematic}
\caption{Schematic diagram of a subglacial-plume. The plume originates at the grounding line, where the ice shelf is inclined at an angle $\alpha$ to the horizontal. The grounding line is located at a depth $-Z_gl >0$ below sea level; we use shifted co-ordinates, with $Z = 0$ corresponding to the depth of the grounding line (i.e. sea level is at $Z = -Z_{gl}$). The plume is quasi-one-dimensional: it is described by its thickness $D(X)$, depth-averaged velocity $U(X)$, depth-averaged salinity $S(X)$, and depth-averaged temperature $T(X)$.  The plume gains mass by melting the ice shelf at a rate $\dot{m}$ and entraining ambient water at a rate $\dot{e}$. The plume is separated from the ice shelf base by a thin turbulent boundary layer across which heat and salt are exchanged with the face; $T_b$ and $S_b$ denote the temperature and salinity on the plume side of this viscous boundary layer. }\label{fig:Schematic}
\end{figure}

We begin by providing a brief outline of the plume model of~\cite{Jenkins1991JGeophysResOceans} and~\cite{Jenkins2011JPhysOcean}. The configuration is shown schematically in figure~\ref{fig:Schematic}. The $X$-axis is aligned with the ice-ocean interface (referred to henceforth as the ice shelf base) at the grounding line, and the $Z$-axis is aligned vertically; the origin of this co-ordinate system is the grounding line. The ice shelf base is located at $Z = Z_b(X)$, and the angle of the base at the grounding line is denoted by $\alpha$ (i.e. $\alpha = Z_b'(0)$, where $'$ denotes differentiation with respect to $X$).

Ultimately, we intend our results to  be applicable to ice shelves in Antarctica, which are characterized by ice shelf bases with low aspect ratios, $\alpha \ll 1$. In particular, this assumption means that the angle of inclination of the ice shelf base from the horizontal can be approximated by $Z_b'(X)$ (rather than a derivative with respect to an arc-length parameter measured along the ice-shelf base) and the distance from the grounding line along the ice shelf base can be approximated by the $X$ co-ordinate. The shallow slope assumption also means that the vertical depth and depth normal to the ice shelf base can be used interchangeably. We shall assume that the derivatives of $Z_b$ are well-defined everywhere, and that the ice shelf base has a monotonic increasing profile $Z_b'(X) >0$. In addition, we shall assume that $\alpha$ is a characteristic slope throughout: $Z_b'(X)\sim \alpha$ for all $X >0$. 

The plume is described in terms of its depth-averaged thickness $D(X)$, velocity $U(X)$, temperature $T(X)$ and salinity $S(X)$ (figure~\ref{fig:Schematic}). The depth-average plume density is denoted by $\rho(X)$. (Variables have no time dependence since the timescale of changes to the shape of the ice shelf base are significantly longer than the timescale of evolution of the plume~\citep{Hewitt2020AnnRevFlu}).  

Temperature and salinity are exchanged across the ice-ocean interface; the temperature and salinity on the plume side of this interface are denoted by $T_b$ and $S_b$, respectively (see figure~\ref{fig:Schematic}). A boundary layer forms within the ice at the ice-ocean interface; the temperature and salinity within in the ice, far from this boundary layer, are denoted by $T_i$ and $S_i$, respectively. The ambient ocean has salinity $S_a(Z)$ and temperature $T_a(Z)$; both of these feed into the ambient density $\rho_a(Z)$, through which the plume `feels' the stratification of the ambient ocean.  We shall discuss in due course the appropriate choice of ambient temperature and salinity to impose the aforementioned two layer stratification. 

The plume is separated from the ice by a viscous boundary layer, across which temperature and salinity are exchanged (inset in figure~\ref{fig:Schematic}); the salinity and temperature on the ice and plume sides of the viscous boundary layer are denoted by $S_i$, $T_i$, and $S_b$, $T_b$ respectively. The ambient ocean has salinity $S_a(Z)$ and temperature $T_a(Z)$; both of these feed into the ambient density $\rho_a(Z)$, through which the plume `feels' the stratification of the ambient ocean.  We shall discuss in due course the appropriate choice of ambient temperature and salinity to impose the aforementioned two layer stratification. 

\subsection{Conservation Equations} 
Under the assumptions described above, as well as a standard Boussinesq approximation, conservation of mass, momentum, salt, and heat require the following system of ordinary differential equations (ODEs) to hold~\citep{Jenkins2011JPhysOcean,Magorrian2016JGeoResOcean}:
\begin{align}
\dd{(DU)}{X} &= \dot{e} + \dot{m},\label{E:Modelling:Model:RawMass}\\
\dd{(DU^2)}{X} &= \frac{D\Delta \rho}{\rho_0} g \dd{Z_b}{X}  -\frac{\tau_T}{\rho_0}\label{E:Modelling:Model:RawMometum}\\
\dd{(DUS)}{X} &= \dot{e}S_a + \dot{m}S_b -\frac{Q_S}{\rho_0}\label{E:Modelling:Model:RawSalt}\\
\dd{(DUT)}{X} &= \dot{e}T_a + \dot{m}T_b -\frac{Q_T}{c_p \rho_0}.\label{E:Modelling:Model:RawTemp}
\end{align}
Here $\tau_T$, $Q_s$, and $Q_T$ are the turbulent fluxes of momentum, heat, and salt to the ice shelf base. We take the following parametrizations for these quantities, based on a quadratic drag law and shear dominated viscous sublayer:
\begin{align}
Q_S &= \rho_0 \mathrm{St}_S U (S - S_b),\label{E:Modelling:Model:TurbulentSalt} \\
Q_T &= c_p \rho_0 \mathrm{St}_T U (T -T_b),\label{E:Modelling:Model:TurbulentHeat}\\
 \tau_T &= \rho_0 C_d U^2.\label{E:Modelling:Model:TurbulentShear}
\end{align}
Here $\mathrm{St}_S, \mathrm{St}_T$ are (constant) haline and thermal Stanton numbers, which parametrize exchange across a viscous sublayer that forms on the underside of the ice-ocean interface, $C_d$ is a drag coefficient, and $c_i$ is the specific heat capacity of ice.  

In~\eqref{E:Modelling:Model:RawMass}--\eqref{E:Modelling:Model:RawTemp}, $\dot{m}$ is the melt rate and $\dot{e}$ is the entrainment rate of ambient water (figure~\ref{fig:Schematic}); here we take a standard entrainment parametrization, 
\begin{equation}\label{E:Modelling:Model:Entrainment}
\dot{e} = E_0 U \dd{Z_b}{X},
\end{equation}
which is based on a competition between shear-induced turbulence and the stabilizing effect of mixing across a sharp density interface~\citep{Pedersen1980,Turner1986JFM}. We use this parametrization, which assumed that the entrainment coefficient $\dot{e}/U = E_0 Z_b'(X)$ has no Richardson number dependence, for simplicity, but note that many Richardson number dependent parametrizations have been proposed in the literature on plumes \cite[see][for example]{Holland2007JGeophysResOceans}. \red{Need some more references here}


In the momentum equation~\eqref{E:Modelling:Model:RawMometum}, we have introduced the buoyancy deficit $\Delta \rho$, which is related to the difference between the salinity and temperature within the plume and that in the ambient ocean by a linear equation of state:
\begin{equation}\label{E:Modelling:Model:EquationOfState}
\frac{\Delta \rho}{\rho_0}  = \frac{\rho_a - \rho}{\rho_0}= \beta_S(S_a - S) - \beta_T (T_a - T).
\end{equation}
Here $\rho_0$ is a reference density, $\beta_S$ is a haline contraction coefficient, and $\beta_T$ is a thermal expansion coefficient. Typical values of all constants introduced here are listed in table~\ref{T:Constants}.

Note that in~\eqref{E:Modelling:Model:RawMometum} we have neglected a term arising from the difference between the slope of the plume-ambient interface and the slope of the ice shelf base, as is standard when describing subglacial plumes. This term only becomes important when the plume thickness is comparable to the length scale associated with freezing point dependence on depth~\citep{Jenkins2011JPhysOcean}. Since this thickness is typically beyond the Ekman length, plume theory is not expected to be applicable here (see \S\ref{S:Introduction}).


\begin{table}[!h]
\caption{Typical parameter values used in the plume model. Values in the top half are from~\cite{Jenkins1991JGeophysResOceans}, with the exception of the drag coefficient $C_d$ and entrainment coefficient $E_0$, where we list only the order of magnitude to reflect the uncertainty in these values~\citep{Hewitt2020AnnRevFlu}. The values in the bottom half relating to the pycnocline are interpreted from~\cite{Jenkins2018NatureGeo}, and are relevant for the Amundsen Sea off the coast of Pine Island Glacier. \red{Note that you have replaced $T_{0,1}$ and $S_{0,1}$ in the ambient temperature and salinity by $T_{l,u}$ and $S_{l,u}$, respectively. Ensure that this is the case throughout the paper.}}\label{T:Constants}
\begin{center}
\begin{tabular}{llll}%%%The number of columns has to be defined here
\hline
Symbol & Description & Typical Value & Units \\
\hline
$\alpha$ &Grounding line basal slope &$3\times 10^{-3}$ &- \\
$E_0$   & Entrainment coefficient    & $10^{-2}$ & -       \\
$\Gamma$      & Freezing point salinity coefficient & $5.73 \times 10^{-2}	$    	  &  $\si{\celsius}~\text{PSU}^{-1}$     \\
$T_0$      & Freezing point offset & $8.32 \times 10^{-2}	$    	  &  $\si{ \celsius}$     \\
$\lambda$      & Freezing point depth coefficient & $7.61 \times 10^{-4}	$    	  &  $\si{\celsius . \meter^{-1}}$     \\
$C_d$ & Drag coefficient & $10^{-3}$ & - \\
$\mathrm{St}$ & Effective thermal Stanton number & $5.9 \times 10^{-4}$ & -\\
$\beta_S$ & Haline contraction coefficient & $7.86 \times 10^{-4} $ & $\text{PSU}^{-1}$ \\
$\beta_T$ & Thermal expansion coefficient & $3.87\times 10^{-5}$ & $\si{\celsius^{-1}}$ \\
$L$ & Latent heat of fusion of ice & $3.35 \times 10^5 $& $\si{\joule . \kg^{-1}}$\\
$c$ & Specific heat capacity ocean water & $3.974 \times 10^3$ & $\si{\joule .\kilogram .\celsius^{-1}}$\\
$c_i$ & Specific heat capacity ice & $2.009 \times 10^3$ & $\si{\joule . \kilogram .\celsius^{-1}}$\\

$\rho_0$ &  Reference ocean density & $1000$ & $\si{\kilogram . \meter^{-3}}$\\
$T_{l}$ & Ambient temperature lower layer &$0.5$        &  $\si{ \celsius}$   \\
$T_{u}$ & Ambient temperature upper layer &$-1.5$        &  $\si{ \celsius}$  \\
$S_{l}$ & Ambient salinity lower layer &$34.6$        &  $\text{PSU}$   \\
$S_{u}$ & Ambient salinity upper layer &$34.0$        &  $\text{PSU}$  \\
$\ell_t$ & Half lengthscale of pycnocline & $50$ & $\si{\meter}$\\
$Z_{gl}$ & Negative grounding line depth & $-1500$ & $\si{\meter}$\\

\hline
\end{tabular}
\end{center}
\vspace*{-4pt}
\end{table}

\red{Edits to here}

\subsubsection{Melting}
To close the system of equations~\eqref{E:Modelling:Model:RawMass}--\eqref{E:Modelling:Model:EquationOfState}, we require a relationship that allow us to eliminate $\dot{m}$, $S_b$, and $T_b$.  The so-called `three-equation formulation' is often applied to provide such a closure, in which the ice-water interface is assumed to be in local thermodynamic equilibrium, so its temperature and salinity satisfy the liquidus condition 
\begin{equation}
    T_b = T_0 + \lambda (Z_{gl} + Z_b) - \Gamma S_b\label{E:Modelling:Model:Closure:3eqn3}
\end{equation}
that relates the interface temperature to the local pressure freezing point~\citep{Holland1999JPhysOcean} (note that $-(Z_b + Z_{gl})$ is the depth below sea level). It is through the liquidus condition~\eqref{E:Modelling:Model:Closure:3eqn3} that the plume `knows' about depth dependence of the freezing point. Heat and salt balances at the interface requiring
\begin{align}
\dot{m}L + \dot{m}c_i (T_b - T_i) &= c \mathrm{St}_T U(T - T_b),\label{E:Modelling:Model:Closure:3eqn1}\\
\dot{m}(S_b - S_i) &= \mathrm{St}_S U(S - S_b),\label{E:Modelling:Model:Closure:3eqn2}
\end{align}  
Here $c, c_i$ are the specific heat capacities of water and ice, respectively, $L$ is the latent heat of fusion, $\Gamma$ is the freezing point salinity coefficient,  $T_0$ is a freezing point offset, and $\lambda$ is the freezing point depth coefficient. The terms on left-hand side of equation~\eqref{E:Modelling:Model:Closure:3eqn1} relate to phase change and heat conduction, respectively; the latter term is based on steady state one-dimensional advection-diffusion and is valid for P\'{e}clet numbers less than five~\citep{Holland1999JPhysOcean}.

A common alternative to the closure~\eqref{E:Modelling:Model:Closure:3eqn1}--\eqref{E:Modelling:Model:Closure:3eqn3} is the `two-equation formulation' described by~\citet{McPhee1992JGeophysResOcean}.This formulation uses an approximate heat balance
\begin{equation}
\dot{m}L + \dot{m}c_i (T_f - T_i) &= c~ \mathrm{St} ~U(T - T_f),\label{E:Modelling:Model:Closure:2eqn1}
%T_f &= T_0 + \lambda (Z_{gl} + Z_b) - \Gamma S,\label{E:Modelling:Model:Closure:2eqn2}
\end{equation}
where the interfacial temperature $T_b$ is replaced by $T_f =T_0 + \lambda (Z_{gl} + Z_b) - \Gamma S$, the freezing temperature outside the boundary layer on the underside of the ice shelf, and $\mathrm{St}$ is a composite Stanton number, which parametrizes exchanges of heat and salt across the boundary layer simultaneously.

Following~\cite{Jenkins2011JPhysOcean}, we use the three equation formulation~\eqref{E:Modelling:Model:Closure:3eqn3}--\eqref{E:Modelling:Model:Closure:3eqn2} to eliminate $(T-T_b)$ and $(S-S_b)$ from the turbulent flux equations~\eqref{E:Modelling:Model:TurbulentSalt} and~\eqref{E:Modelling:Model:TurbulentHeat}, and the two equation formulation subsequently. From~\eqref{E:Modelling:Model:Closure:2eqn1}, the melt rate is then
\begin{equation}\label{E:Modelling:Model:Closure:mdot}
\dot{m} = M_0 U \Delta T,  
\end{equation}
where 
\abeqn{E:Modelling:Model:MeltRatePrefAndEffTemp}{
M_0 = \frac{\mathrm{St}}{T_f - T_i^{\text{ef}}}, \qquad T_i^{\text{ef}} = T_f - \frac{L + c_i(T_f - T_i)}{c}}
are the melt rate prefactor and effective temperature of melt water from the ice, respectively, and $\Delta T = T - T_f$ is the thermal driving. 

The ice and freezing temperatures are typically within a few degrees of one another so $c_i(T_f - T_i)/ L \ll 1$, and the effective temperature of released melt water is dominated by latent heat: $T_i^{\text{ef}} \approx -L/c \approx -84\si{\celsius}$. It is therefore reasonable to neglect the contribution to the melt rate from diffusive heat flux, in which case the melt rate prefactor~\eqref{E:Modelling:Model:MeltRatePrefAndEffTemp}a reduces to
\begin{equation}\label{E:Modelling:Model:Closure:M0_simple}
 M_0 = \frac{c~\mathit{St}}{L}.
\end{equation}
Similarly, the effective temperature of melt water from the ice is significantly colder than ambient, so the effective melt water density contrast,
\begin{equation}\label{E:Modelling:Model:EffectiveDensity}
\Delta \rho_i^{\text{ef}} = \rho_0 \left[\beta_S\left(S_a - S_i\right) - \beta_T\left(T_a - T_i^{\text{ef}}\right)\right]  \approx \rho_0 \left[\beta_S\left(S_a - S_i\right) - \beta_T\frac{L}{c}\right].
\end{equation}
%at this point we have the equations we will work with henceforth (i.e. all the terms here will be retained)
\subsubsection{Reformulation in terms of buoyancy deficit and thermal driving}
Inserting the expressions~\eqref{E:Modelling:Model:TurbulentSalt}--\eqref{E:Modelling:Model:TurbulentShear} for the turbulent flux, the entrainment parametrization~\eqref{E:Modelling:Model:Entrainment}, the heat and salt balances~\eqref{E:Modelling:Model:Closure:3eqn1}--\eqref{E:Modelling:Model:Closure:3eqn2}, and the melt rate relation~\eqref{E:Modelling:Model:Closure:M0_simple} into the conservation equations~\eqref{E:Modelling:Model:RawMass}--\eqref{E:Modelling:Model:RawTemp} gives a system of equations that can be rearranged to be expressed as conservation equations for fluxes of mass, momentum, buoyancy deficit, and thermal driving. Using the approximations~\eqref{E:Modelling:Model:Closure:M0_simple} and~\eqref{E:Modelling:Model:EffectiveDensity}, this system of equations reads
\begin{align}
\dd{(DU)}{X} &= E_0 U \dd{Z_b}{X}+ \frac{c~\textit{St}}{L}U\Delta T,\label{E:Modelling:Model:Mass}\\
\dd{(DU^2)}{X} &= g \dd{Z_b}{X} \frac{\Delta \rho }{\rho_0} D - C_d U^2, \label{E:Modelling:Model:Mom}\\
\dd{(DU\Delta \rho)}{X} &= \frac{c~\textit{St}~\rho_0}{L}\left(\beta_S S_a - \beta_T \frac{L}{c}\right) U\Delta T + \rho_0\left(\beta_S \dd{S_a}{Z}-\beta_T \dd{T_a}{Z}\right) \dd{Z_b}{X} DU, \label{E:Modelling:Model:Buoyancy}\\
\dd{(DU\Delta T)}{X} &= \left\{T_a - T_{f}^0 + \Gamma \left[S_a - S_a(0)\right] - \lambda Z_b\right\}E_0 U \dd{Z_b}{X} - \mathrm{St}U \Delta T - \lambda \dd{Z_b}{X} DU.
\label{E:Modelling:Model:Thermal}
\end{align}
Here we have set the ice salinity to zero and introduced
\begin{equation}
T_{f}^0 = T_0 + \lambda Z_{gl} - \Gamma S_a(0),
\end{equation}
the freezing temperature associated with the ambient salinity at the depth of the grounding line.

\subsubsection{Ambient Stratification}\label{S:Model:Pycnocline}
\begin{figure}
\centering
\includegraphics[scale =0.4]{./figures/fig2_ambient_temp_and_salinity}
\caption{Plot of (a) the ambient salinity profile~\eqref{E:Modelling:Pycnocline:Sa} and (b) ambient temperature profile~\eqref{E:Modelling:Pycnocline:Ta} as a function of distance above sea level, $Z + Z_{gl}$, using a grounding line depth $Z_{gl} = -1500~\si{\meter}$ and pycnocline lengthscale $\ell_t = 50~\si{\meter}$. In both plots, the shaded blue area indicates the region $Z_0 - 2\ell_t < Z < Z_0 + 2\ell_t$ in which the majority of the change in the salinity and temperature occurs across the pycnocline.}\label{fig:Pycnocline_Profiles}
\end{figure}

As discussed, we assume a two-layer ambient stratification in which warm, salty water of temperature $T_l$ and salinity $S_l$ is overlain by cold, fresh water of temperature $T_u < T_l$ and salinity $S_u < S_l$. The two layers are separated by a thin pycnocline centred at a depth $Z = Z_0$, which has a characteristic thickness scale $\ell_t$. We impose this ambient stratification by taking
\begin{align}
S_a(Z) &= \frac{1}{2}\left[S_l + S_u - (S_l - S_u)\tanh\left(\frac{Z - Z_0}{\ell_t}\right)\right],\label{E:Modelling:Pycnocline:Sa}\\
T_a(Z) &= \frac{1}{2}\left[T_l + T_u - (T_l - T_u)\tanh\left(\frac{Z - Z_0}{\ell_t}\right)\right],\label{E:Modelling:Pycnocline:Ta}
\end{align}
in~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal}. We assume that the pycnocline is located reasonably far from the grounding line (this assumption shall be formalized mathematically in due course). Profiles of~\eqref{E:Modelling:Pycnocline:Sa}--\eqref{E:Modelling:Pycnocline:Ta} are shown in figure~\ref{fig:Pycnocline_Profiles}.

\subsection{Similarity Solution}\label{S:Model:SimilaritySolution}
Before we proceed with a non-dimensionalization of the model equations~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal}, it is instructive to consider the behaviour near the grounding line. There, the in situ freezing point is approximately constant, the ice shelf base has an approximately constant slope ($Z_b(X) \approx \alpha X$), and the plume has no information about gradients in the ambient temperature or salinity. Under these conditions, the problem has no intrinsic length scale and a similarity solution to~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal} exists~\citep{Magorrian2016JGeoResOcean}:
\begin{align}
D &= \frac{2}{3}E_0 \alpha X, & U &= \left[\frac{2E_0 \alpha^2 g}{\left(4E_0 \alpha + 3 C_d\right)} \frac{\Delta \rho}{\rho_0}\right]^{1/2}X^{1/2},\label{E:Similarity:SimilaritySol1}\\
 \frac{\Delta \rho}{\rho_0} &= \frac{St}{E_0 \alpha}\frac{\Delta T}{L/c}\left(\beta_S S_l - \beta_T \frac{L}{c}\right), & \Delta T &= \frac{E_0 \alpha}{E_0 \alpha + St}\tau.\label{E:Similarity:SimilaritySol2}
\end{align}
where $\tau = T_l - T_{f}^0$ is the difference between the ambient and local freezing temperatures at the grounding line.  Note that in~\eqref{E:Similarity:SimilaritySol1}--\eqref{E:Similarity:SimilaritySol2}, we have neglected the mass contribution from ice shelf melting; we shall demonstrate in \S\ref{S:Asymptotics} that this is reasonable for locations close to the grounding line.

The Richardson number, which quantifies the relative strength of buoyancy and drag, associated with~\eqref{E:Similarity:SimilaritySol1}--\eqref{E:Similarity:SimilaritySol2} is
\begin{equation}\label{E:Similarity:Richardson}
\mathrm{Ri} = \frac{\Delta \rho}{\rho_0}\frac{D g \cos \alpha}{U^2} = \frac{4E_0 \alpha + 3C_d}{3} \frac{\cos \alpha}{\alpha} \approx \frac{C_d}{\alpha},
\end{equation}
where the final approximation makes use of $E_0 \alpha \ll C_d$ and $\alpha \ll 1$ (table~\ref{T:Constants}). In general, if the Richardson number is less than unity, the plume velocity is greater than its internal wave speed and disturbances cannot propagate upstream; in this case numerical solutions of~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal} are stable to perturbations~\citep{Jenkinsphdthesis}. If, however, the Richardson number is greater than unity, interfacial waves can propagate upstream, and solutions of~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal} are numerically unstable. Taking the approximation~\eqref{E:Similarity:Richardson} as a proxy to the global Richardson number, we restrict ourselves here to sufficiently steep ice shelf bases with $C_d/\alpha < 1$ to ensure numerical stability.

\subsection{Non-dimensionalization}\label{S:Model:NonDim}
We use the similarity solution~\eqref{E:Similarity:SimilaritySol1}--\eqref{E:Similarity:SimilaritySol2} to provide relationships between the scales of the variables (denoted by square brackets):
\begin{align}
\left[D\right] &= E_0 \alpha \left[X\right], & \left[U\right] &= \left(\frac{\beta_S S_l g E_0 \alpha^2 \tau}{C_d ~L/c}\right)^{1/2}[X]^{1/2},\label{E:Similarity:Scales1}\\
\left[\Delta \rho\right] &= \beta_S S_l \rho_0 \frac{\tau}{L/c}, & \left[\Delta T\right] &= \frac{E_0 \alpha}{St}\tau,\label{E:Similarity:Scales2}
\end{align}
where we have used $E_0 \alpha \ll C_d$, $St$ and $\beta_T L /c \ll \beta_S S_l$.

We take the vertical lengthscale
\begin{equation}
\left[Z\right] = \ell_0=\frac{ \tau }{\lambda}.
\end{equation}
This is the vertical distance associated with a change in the local freezing point from that given by the difference between ambient and in situ freezing temperatures at the grounding line, to zero degrees. The corresponding length scale in the $X$-direction is
\begin{equation}\label{E:NonDim:Xscale}
\left[X\right] =\frac{ \ell_0}{\alpha}=\frac{ \tau }{\alpha \lambda}.
\end{equation}

Combining the expressions~\eqref{E:Similarity:Scales1}--\eqref{E:NonDim:Xscale} gives a consistent set of variable scales; the problem is non-dimensionalized by introducing variables scaled accordingly (denoted by  $\hat{.}$):
\begin{align}
D&= E_0 \ell_0 \hat{D}, & U&= \left(\frac{E_0 \alpha}{C_d} \frac{\tau}{L/c}~\beta_s S_l ~\ell_0  g\right)^{1/2}\hat{U}, & Z_b &= \ell_0 \hat{Z}_b\label{E:NonDim:NonDimVar1}\\
\frac{\Delta \rho}{\rho_0} &= \beta_S S_l \frac{\tau}{L/c}\Delta \hat{\rho}, & \Delta T &= \frac{E_0 \alpha}{St}\tau \Delta \hat{T} & X &=\ell_0\hat{X}. \label{E:NonDim:NonDimVar2}
\end{align}
\red{Do you want to add a comment on the dimensionless groups identified here?}
 \renewcommand{\lambda}{\kappa}

Combining model equations~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal} with the ambient salinity and temperature~\eqref{E:Modelling:Pycnocline:Sa}--\eqref{E:Modelling:Pycnocline:Ta} and inserting~\eqref{E:NonDim:NonDimVar1}--\eqref{E:NonDim:NonDimVar2} gives
\begin{align}
\dd{(\hat{D}\hat{U})}{\hat{X}} &= \hat{U} \dd{\hat{Z}_b}{\hat{X}} +\epsthree \hat{U} \Delta \hat{T},\label{E:NonDim:mass}\\
\epsone \dd{(\hat{D}\hat{U}^2)}{\hat{X}} &= \hat{D} \Delta \hat{\rho} \dd{\hat{Z}_b}{\hat{X}} - \hat{U}^2,\label{E:NonDim:mom} \\
\dd{(\hat{D}\hat{U}\Delta \hat{\rho})}{\hat{X}}  &= -\frac{\Pb}{\delta} \mathrm{sech}^2\left(\frac{\hat{X} - \hat{X}_0}{\lt}\right)\dd{\hat{Z}_b}{\hat{X}} \hat{D}\hat{U}+
 \left[\lambda - \epsfour \tanh \left(\frac{\hat{X} - \hat{X}_0}{\lt}\right) \right] \hat{U} \Delta \hat{T}\label{E:NonDim:buoyancy} \\
\epstwo \dd{(\hat{D}\hat{U}\Delta \hat{T})}{\hat{X}} &= \left\{1 - \hat{Z}_b - \Pt\left[1 + \tanh\left(\frac{\hat{X} - \hat{X}_0}{\lt}\right)\right]\right\} \hat{U}\dd{\hat{Z}_b}{\hat{X}}  - \hat{U}\Delta \hat{T}- \hat{D}\hat{U}\dd{\hat{Z}_b}{\hat{X}}.\label{E:NonDim:thermal}
 \end{align}
Here $\hat{X}_0$ is the $\hat{X}$ co-ordinate at which the ice shelf base passes through the centre of the pycnocline, i.e. $\hat{Z}_b(\hat{X}_0) = \hat{Z}_0$. Our assumption that the pycnocline is located away from the grounding line is encoded by assuming $\hat{X}_0 = \order{1}$.

\begin{table}[!h]
\caption{Dimensionless parameters in the model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}. Typical values are based on the values of variables listed in table~\ref{T:Constants}.}\label{T:Dimensionless_Parameters}
\begin{center}
\begin{tabular}{llll}

Parameter name  & Definition   & Typical Value \\
\hline 
\vspace{2pt}
\vspace{2pt}$\epsone$ & $  \frac{E_0 \alpha}{C_d} $  &$ 3 \times 10^{-2}$ \\
\vspace{2pt}$\epstwo$ & $  \frac{E_0 \alpha}{St} $ & $ 5 \times 10^{-2}$ \\
\vspace{2pt}$\epsthree$ & $  \frac{\tau}{L/c} $ & $ 4 \times 10^{-2}$ \\
\vspace{2pt}$\epsfour$ & $  \frac{S_l - S_u}{2 S_l} $  &$ 2 \times 10^{-2}$ \\
\vspace{2pt}$\lt$ & $  \frac{\ell_t}{\ell_0} $ & $  5 \times 10^{-3}$ \\
\vspace{2pt}$\Pb$ & $  \frac{L/c}{ \tau}\frac{S_l - S_u}{2S_l}\left[1 - \frac{\beta_T (T_l - T_u)}{\beta_S (S_l - S_u)}\right]$   & $  0.2$ \\
\vspace{2pt}$\Pt$ & $ \frac{T_l - T_u + \Gamma( S_l - S_u)}{2 \tau}$ & $  1.2$ \\
\vspace{2pt}$\lambda$ & $ \frac{S_l + S_u}{2S_l} -  \frac{\beta_T L/c}{ \beta_S S_l}$ &  $  1.2$ \\
\hline
\vspace{2pt}$k_2$ & $\frac{\epstwo}{\epsone}$ & 1.7\\
\vspace{2pt}$k_3$ & $\frac{\epsthree} {\epsone}$ & 1.4\\
\vspace{2pt}$k_4$ & $\frac{\epsfour}{\epsone}$ & 0.3\\
\end{tabular}
\end{center}
\vspace*{-4pt}
\end{table}
 

 
As well as the dimensionless pycnocline position $\hat{X}_0$, there are further eight dimensionless parameters in the system~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}, which are defined in table~\ref{T:Dimensionless_Parameters}. We adopt the naming convention that small parameters are denoted by $\epsilon_i$, with the exception of the dimensionless pycnocline thickness $\delta = \ell_t / \ell_0$, since this parameter is unique in defining a region of the solution, as we shall see. The other dimensionless variables, $\Pb$, $\Pt$, and $\lambda$, are treated as $\order{1}$.

As we shall see in \S\ref{S:Asymptotics}, $\Pb$ captures the dominant contribution to buoyancy deficit changes across the pycnocline. Its typical value is positive (table~\ref{T:Dimensionless_Parameters}), suggesting that buoyancy changes across the pycnocline are predominantly the result of changes in ambient salinity rather than ambient temperature.

The final term on the right-hand side of~\eqref{E:NonDim:buoyancy} corresponds to meltwater contributions to density changes. The parameters $\kappa$ and $\epsfour$ capture the effect of the depth-mean and depth-dependent contributions, respectively, to ambient salinity and temperature in controlling this buoyancy deficit contribution; that $\epsfour \ll \kappa$ indicates that the depth-mean contribution plays the dominant role.

The parameter $\Pt$ measures the strength of changes in thermal driving across the pycnocline. Although we include salinity variations in the definition of $\Pt$, we note that $\Gamma (S_l - S_u)/(T_l - T_u) \ll 1$ (table~\ref{T:Constants}) and thus the parameter $\Pt$ is dominated by temperature variations in the ambient.

To make progress using asymptotic methods, we must specify the relative sizes of the small parameters $\lt$ and $\epsilon_i, ~i = 1\dots4$. Based on the typical values listed in table~\ref{T:Dimensionless_Parameters}, we assume that $\epsone, \epstwo, \epsthree, \epsfour$ and $\lt$ have the same asymptotic order with $\epstwo, \epsthree, \epsfour, \lt = \order{\epsone}$. To simplify the notation to a single small parameter ($\epsone$), we therefore introduce the $\order{1}$ parameters $k_i =\epsilon_i/ \epsone,~i = 2,3,4$ (values of the $k_i$ are also given in table~\ref{T:Dimensionless_Parameters}).

The problem~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} is closed by specifying a single boundary condition at the grounding line. Our assumption of negligible subglacial discharge is encoded by taking
\begin{equation}\label{E:NonDim:IC1}
\hat{U} =0,~\hat{D} = 0
\end{equation}
at $\hat{X} = 0$. The boundary conditions on the buoyancy deficit and thermal driving are obtained by evaluating (the dimensionless version of) the similarity solution~\eqref{E:Similarity:SimilaritySol1}--\eqref{E:Similarity:SimilaritySol2} in the limit $\hat{X} \to 0$. To leading order in $\order{\epsone}$ this is
\begin{equation}\label{E:NonDim:IC2}
  \Delta\hat{\rho}(0) = \kappa,~\Delta \hat{T}(0) = 1  
\end{equation}
at $\hat{X} = 0$.

Henceforth, hats are dropped on both parameters and variables, and all quantities are assumed dimensionless, unless otherwise stated.

\subsection{Example Solutions}\label{S:ExampleSolutions}

\begin{figure}
\centering
\includegraphics[width = \textwidth]{./figures/fig3_example_solutions}
\caption{Numerical solutions of dimensionless plume equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}. Solutions are shown for (a) no stratification, (all parameters as in table~\ref{T:Dimensionless_Parameters} except $P_b = 0$, $\Pt = 0$, $\epsfour = 0$) and (b)  a typical two-layer ambient stratification (all parameters as in table~\ref{T:Dimensionless_Parameters}). Here we take a linear ice shelf base, $Z_b(X) = X$. The dashed horizontal line indicates $X_{\text{stop}}$, where the plume velocity reaches zero. The dot-dashed horizontal line indicates $Z = |Z_{gl}|$, the dimensionless depth of the grounding line, which restricts the solution domain in practice (see main text). In (b), the solid grey line indicates $X = X_0$, the centre of the pycnocline. Shading (and numbers in the third panel) indicate schematically the regions described in \S\ref{S:ExampleSolutions} and introduced formally in \S\ref{S:Asymptotics}. }\label{fig:ExampleSols}
\end{figure}

Before proceeding with an asymptotic analysis of the model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} it is instructive to consider typical solutions, which provide insight into the characteristic behaviour and the influence of ambient stratification on it. These solutions are obtained numerically; to do so, we first express the~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} as a single ODE of the form
\begin{equation}\label{E:ExampleSolutions}
\mathsfbi{M} \dd{\mathbf{Y}}{X} = \mathbf{F}
\end{equation}
where $\mathbf{Y} = (D, U, \Delta \rho, \Delta T)^\intercal$, and $M$ and $F$ play the roles of a mass matrix and force, respectively. The ODE~\eqref{E:ExampleSolutions} is solved numerically using the stiff 
ODE solver \texttt{ODE15s} implemented in~\textsc{MATLAB}.  Software code to reproduce the calculations and figures in the paper is available at reference~\citep{PycnoclineCode}.

We consider first the limiting case in which there is no ambient stratification, taking $\Pb = 0, \Pt = 0, \epsfour = 0$ in~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}. Solutions of~\eqref{E:ExampleSolutions} in this case are shown in figure~\ref{fig:ExampleSols}a; the observed behaviour has been described in detail elsewhere~\citep[see][for example]{Jenkins1991JGeophysResOceans, Jenkins2011JPhysOcean, Magorrian2016JGeoResOcean, Hewitt2020AnnRevFlu}: briefly, the plume accelerates as it moves away from the grounding line, where it is strongly buoyant; the high velocities and strong thermal driving at depth result in high melt rates near the grounding line (figure~\ref{fig:ExampleSols}a fourth panel). As the plume rises, it entrains salty (dense) ambient water, which leads to a retardation of the velocity (second panel), and the local freezing point increases; eventually (at $X \approx 0.5$ in figure~\ref{fig:ExampleSols}a), the thermal driving, and thus melt rate, becomes negative, indicating refreezing (fourth panel). Beyond this point, meltwater is being removed from the plume, further increasing its density (reducing its density deficit, second panel), in addition to continued entrainment of salty ambient water. The plume becomes negatively buoyant further downstream (at $X \approx 0.9$ in figure~\ref{fig:ExampleSols}a). It continues to move upwards, driven by its momentum but increasingly restrained by gravity; its velocity ultimately reaches zero, and the plume thickness diverges, at a point we denote $X = X_{\text{stop}}$. Note that, although we show results for all $X < 1$ here, $X$ is restricted in practice by the grounding line depth: the subglacial plume can only extend as far as the sea level. For typical grounding line depths and constant ambient salinity, it is uncommon to encounter the region of refreezing (figure~\ref{fig:ExampleSols}a). 

With two-layer ambient stratification imposed (figure~\ref{fig:ExampleSols}b), the behaviour is identical below the pycnocline: the plume does not know about the pycnocline until it is very close to it. Across the pycnocline, however, each of the dependent variables experience a sharp change; as the plume enters the pycnocline it suddenly `sees' ambient conditions that are significantly colder and fresher. The plume leaves the region around the pycnocline with lower speed and thermal driving than in the corresponding unstratified case, and both the point at which the plume reaches neutral buoyancy and the point at which the plume speed, and thus melt rate, approach zero are reduced (for the values used in figure~\ref{fig:ExampleSols}, the value of $X_{\text{stop}}$ in the stratified case is approximately half of its value in the unstratified case).

%describe layers
The behaviour observed in this stratified case can be divided qualitatively into four distinct regions, which are indicated in figure~\ref{fig:ExampleSols}b. The first is adjacent to the grounding line, where the plume behaves as in the unstratified case; the second region surrounds the pyncocline; the third lies above the pycnocline, where the plume decelerates and the buoyancy deficit reduces steadily; the fourth lies adjacent to $X_{\text{stop}}$, where the plume velocity quickly transitions to zero and the plume thickness diverges.  These four regions are defined formally in the asymptotic analysis, which we turn to now. 


\section{Asymptotic Analysis}\label{S:Asymptotics}
In this section, we present an asymptotic analysis of the model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}, with a view to constructing an analytic approximation to the scaled melt rate $M = U \Delta T$. Here we consider only the leading order behaviour: all of the dependent variables discussed in this section can be considered to be leading order terms in an asymptotic expansion~\citep{HinchPerturbationMethods} in powers of $\epsone$. 

As part of this analysis, the four regions introduced descriptively in the previous section emerge naturally; in turn, we formally define each region, then make a variable scaling (if appropriate) and describe the structure of solutions to the resulting leading order equations. In each region, this analysis reveals where the solution to the leading order equations breaks down; by analysing the behaviour close to this point, we obtain matching conditions for the next region downstream. As we shall see, each region has a different balance in the momentum equation to the region located upstream of it; these balances can therefore be used to characterize the regions and are listed in table~\ref{T:Balances}. 

Note that throughout this section, we use $'$ to denote derivatives with respect to $X$, and the argument of variables is $X$ unless specified.

\begin{table}[h!]
\caption{Nomenclature and momentum balances in the regions described in the asymptotic analysis of \S\ref{S:Asymptotics}.}
\label{T:Balances}
\begin{center}
\begin{tabular}{lll}
  Region  & Descriptive name & Leading order momemtum balance    \\ \hline
   1  & Below the pycnocline & Buoyancy, drag \\
   2  & Pycnocline & Inertia, buoyancy, drag \\
   3  & Above the pycnocline & Buoyancy, drag \\
   4  & Stopping & Inertia,  buoyancy, drag
\end{tabular}
\end{center}
\vspace{-4pt}
\end{table}


\subsection{Region one: below the pycnocline}\label{S:Asymptotics:Region1}
The first region is immediately upstream of the grounding line,  with $X  <  X_0$,  $X= \order{1}$, and $X - X_0 = \mathcal{O}(1)$. We refer to this as region one or, `below the pycnocline'. Here, the leading order equations (i.e. retaining only leading order terms in~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}) are:
\begin{align}
%\dd{(DU)}{X} &= U \dd{Z_b}{X},\label{E:Region1:mass}\\
%0 &= D \Delta \rho \dd{Z_b}{X} - U^2, \label{E:Region1:mom}\\
%\dd{(DU\Delta \rho)}{X}  &=\lambda U \Delta T\label{E:Region1:buoyancy}\\
%0&= (1  - Z_b)\dd{Z_b}{X}U- U\Delta T - DU \dd{Z_b}{X}.\label{E:Region1:thermal}
(DU)' &= U Z_b',\label{E:Region1:mass}\\
0 &= D \Delta \rho Z_b' - U^2, \label{E:Region1:mom}\\
(DU\Delta \rho)'  &=\lambda U \Delta T\label{E:Region1:buoyancy}\\
0&= (1  - Z_b)Z_b' U- U\Delta T - DU Z_b'.\label{E:Region1:thermal}
\end{align}
Equation~\eqref{E:Region1:mass} demonstrates that contributions to mass conservation from melting are not important near the grounding line, as we suggested earlier in \S\ref{S:Model:SimilaritySolution}. 
The system~\eqref{E:Region1:mass}--\eqref{E:Region1:thermal} is the same as considered by~\cite{Lazeroms2019JPhysOcean}, albeit with a general ice shelf basal geometry shape; following~\cite{Lazeroms2019JPhysOcean}, we make progress by considering the flux $Q= DU$. Mass conservation~\eqref{E:Region1:mass} gives a first relationship between the flux and the velocity:
\begin{equation}\label{E:Region1:U_Q_relation1}
U = \frac{Q'}{Z_b'}.
\end{equation}
A second relationship is obtained by eliminating $\Delta \rho$ from~\eqref{E:Region1:mom}--\eqref{E:Region1:buoyancy} and combining the result with~\eqref{E:Region1:thermal}:
\begin{equation}\label{E:Region1:U_Q_relation2}
%\dd{}{X}\left(\frac{U^3}{Z_b'}\right) = \dd{}{X}\left[\lambda (1-Z_b)Q\right]
\left[\frac{U^3}{Z_b'} - \lambda (1 - Z_b)Q\right]' = 0.
\end{equation}
Eliminating the speed $U$ from~\eqref{E:Region1:U_Q_relation1} and~\eqref{E:Region1:U_Q_relation2}, gives a second order ODE for $Q$, which can be integrated once using the boundary condition~\eqref{E:NonDim:IC1} to give
\begin{equation}\label{E:Region1:flux_ODE}
(Q')^3 = \lambda\left(Z_b'\right)^4 \left(1-Z_b\right)Q.
\end{equation}
The solution to~\eqref{E:Region1:flux_ODE} that satisfies $Q \to 0$ as $X \to 0$ is
\begin{equation}\label{E:Region1:flux_solution}
Q(X) =  \left(\frac{2}{3}\right)^{3/2} \lambda^{1/2}I(X)^{3/2},
\end{equation}
where 
\begin{equation}\label{E:Region1:flux_solution_integral}
I(X) =  \int_0^X \left[Z_b'(\xi)\right]^{4/3}\left[1 - Z_b(\xi)\right]^{1/3}~\mathrm{d}\xi.
\end{equation}

The plume velocity can then be determined using~\eqref{E:Region1:U_Q_relation1} and~\eqref{E:Region1:flux_solution},
\begin{equation}\label{E:Region1:velocity_solution}
U(X) =\left(\frac{2\lambda}{3}\right)^{1/2}\left[Z_b'(X)\right]^{1/3}\left[1 - Z_b(X)\right]^{1/3}I(X)^{1/2}.
\end{equation}
Finally, the plume thickness, buoyancy deficit, and thermal driving can then be determined algebraically from~\eqref{E:Region1:mom} and~\eqref{E:Region1:thermal},
\begin{align}
%D &= \frac{2}{3}\left[Z_b'(X)\right]^{-1/3}\left[1 - Z_b(X)\right]^{-1/3}I(X),\label{E:Region1:thickness_solution}\\
D(X) &= \frac{2}{3}\left[Z_b'(X)\right]^{-1/3}\left[1 - Z_b(X)\right]^{-1/3}I(X),\label{E:Region1:thickness_solution}\\
\Delta \rho(X) &= \kappa \left[ 1- Z_b(X)\right],\label{E:Region1:buoyancy_solution}\\
%\Delta T &= Z_b'(X)\left[1 - Z_b(X)\right]\left\{1 - %\frac{2}{3}I(X)\left[Z_b'(X)\right]^{1/3}\left[1-Z_b(X)\right]^{-4/3}\right\}
\Delta T &= \left[1-Z_b(X)\right]Z_b'(X) - \frac{2}{3}\left[Z_b'(X)\right]^{2/3} \left[1-Z_b(X)\right]^{-1/3}I(X) \label{E:Region1:thermal_solution}
\end{align}
The leading order contribution to the scaled melt rate in region one is the product of~\eqref{E:Region1:velocity_solution} and~\eqref{E:Region1:thermal_solution} and is stated explicitly in \S\ref{S:MeltRate}. Note that the presence of the integral~\eqref{E:Region1:flux_solution_integral}  in the solution~\eqref{E:Region1:flux_solution}--\eqref{E:Region1:thermal_solution} indicates that the melt rate at an arbitrary point below the pycnocline depends on the geometry of the ice shelf base everywhere upstream of it.

Note that by taking the limit $X \to 0$ in~\eqref{E:Region1:flux_solution}--\eqref{E:Region1:thermal_solution}, we recover 
\begin{equation}\label{E:Region1:dimensionless_similarity}
D = \frac{2}{3}X, \quad U = \left(\frac{2\lambda}{3}\right)^{1/2}X^{1/2}, \quad \Delta \rho = \lambda, \quad \Delta T = 1,
\end{equation} 
which are the leading order terms of an asymptotic expansion in $\epsone$ of the similarity solution~\eqref{E:Similarity:SimilaritySol1}--\eqref{E:Similarity:SimilaritySol2} rescaled according to~\eqref{E:NonDim:NonDimVar1}--\eqref{E:NonDim:NonDimVar2}, as expected.

In general, the integrals arising in~\eqref{E:Region1:flux_solution}--\eqref{E:Region1:thermal_solution} cannot be evaluated analytically. However, in the case special case of a planar geometry ($Z_b(X) = X$), we can compute
\begin{equation}
    I = \frac{3}{4}\left[1 - (1 - X)^{4/3}\right],
\end{equation}
and the corresponding flux is
\begin{equation}\label{E:Region1:Lazeroms_flux}
Q =  \sqrt{\frac{\lambda}{8}}\left[1 - (1-X)^{4/3}\right]^{3/2},
\end{equation}
which is equivalent to the result derived by~\cite{Lazeroms2019JPhysOcean}.

Note that in the absence of ambient stratification, the solution~\eqref{E:Region1:flux_solution}--\eqref{E:Region1:thermal_solution} applies for all $X> 0$ where $X - 1 = \mathcal{O}(1)$ (the solution~\eqref{E:Region1:velocity_solution} breaks down as $X \to 1$ when $Q \to 0$ but this point is well beyond typical depths, as discussed in \S\ref{S:ExampleSolutions}). We shall discuss this further in \S\ref{S:Numerics}.

\subsection{Region two: pycnocline}\label{S:Asymptotics:Region2}
The analysis of the previous section is valid while $X - X_0 = \mathcal{O}(1)$; the leading order solution~\eqref{E:Region1:flux_solution}--\eqref{E:Region1:thermal_solution} breaks down when the plume approaches the pycnocline with $X - X_0 = \order{\delta}$. To analyze the behaviour there, we set
\begin{equation}\label{E:pycnocline:length_scaling}
X = X_0 + \lt \zeta
\end{equation}
where $\zeta = \mathcal{O}(1)$. 

%note we state the rescaled full equations because we'll refer back to them when comparing to leading order solutions
Inserting~\eqref{E:pycnocline:length_scaling} into model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} gives
\begin{align}
\dd{(DU)}{\zeta} &=\lt U Z_b'(X_0 + \lt \zeta) + k_3 \epsone \lt U \Delta T,		\label{E:PycnoclineRegion:MassFull}	\\
\cone \dd{(DU^2)}{\zeta} &=  D\Delta \rho Z_b'(X_0 + \lt \zeta)  -  U^2,	\label{E:PycnoclineRegion:MomFull}	\\
\dd{(DU\Delta \rho)}{\zeta} &= -\Pb \mathrm{sech}^2(\zeta)Z_b'(X_0 + \lt \zeta)DU + \lt \left[\lambda - k_4 \epsone \tanh(\zeta)\right] U \Delta T \label{E:PycnoclineRegion:BuoyancyFull}		\\
\ctwo \dd{(DU\Delta T)}{\zeta} &= \left\{1 - Z_b(X_0 + \lt \zeta) - \Pt\left[1 + \tanh(\zeta)\right] - D\right\}UZ_b'(X_0 + \lt \zeta) -U\Delta T.\label{E:PycnoclineRegion:ThermalFull}
\end{align}
Here the constants $c_i = \epsilon_i / \delta = \order{1}, i = 1, 2$ have been introduced for clarity. 

Retaining only leading order terms in~\eqref{E:PycnoclineRegion:MassFull}--\eqref{E:PycnoclineRegion:ThermalFull}, we obtain
\begin{align}
\dd{(DU)}{\zeta} &=0,		\label{E:PycnoclineRegion:Mass}	\\
\cone \dd{(DU^2)}{\zeta} &=  D\Delta \rho Z_b'(X_0) - U^2,	\label{E:PycnoclineRegion:Mom}	\\
\dd{(DU\Delta \rho)}{\zeta} &= -\Pb \mathrm{sech}^2(\zeta)Z_b'(X_0)DU  \label{E:PycnoclineRegion:Buoyancy}		\\
\ctwo \dd{(DU\Delta T)}{\zeta} &= \left\{1 - Z_b(X_0) - \Pt\left[1 + \tanh(\zeta)\right]  -D\right\}UZ_b'(X_0) - U\Delta T.\label{E:PycnoclineRegion:Themal}
\end{align}
which are to be solved on $-\infty < \zeta < \infty$. (For the numerical solution presented below, we solve~\eqref{E:PycnoclineRegion:Mass}--\eqref{E:PycnoclineRegion:Themal} on $-\zeta_0 < \zeta < \zeta_0$ where $|\zeta_0| \ll \epsone^{-1}$.)

Matching with region one simply involves evaluating~\eqref{E:Region1:velocity_solution}--\eqref{E:Region1:thermal_solution} at $X = X_0$; these quantities are denoted by a subscript `in':
\abcdeqn{E:PycnoclineRegion:FarField}{
U \to U_{\text{in}}, \quad D \to D_{\text{in}}, \quad \Delta \rho \to \Delta \rho_{\text{in}}, \quad \Delta T \to \Delta T_{\text{in}} \quad \text{as}~\zeta \to -\infty,}
To give an explicit example: from~\eqref{E:Region1:velocity_solution}, we see that
\begin{equation}\label{E:PycnoclineRegion:U_in}
U_{\text{in}}=\left(\frac{2\lambda}{3}\right)^{1/2}\left[Z_b'(X_0)\right]^{1/3}\left[1 - Z_b(X_0)\right]^{1/3}I(X_0)^{1/2}.
\end{equation}

To make progress, we first note that, from~\eqref{E:PycnoclineRegion:Mass}, flux is conserved across the pycnocline:
\begin{equation}\label{E:PycnoclineRegion:Q_conserved}
Q(\zeta) = Q_{\in} = D_{\in} U_{\in}  =\left(\frac{2}{3}\right)^{3/2} \lambda^{1/2}I(X_0)^{3/2}.
\end{equation}
Inserting~\eqref{E:PycnoclineRegion:Q_conserved} into~\eqref{E:PycnoclineRegion:Buoyancy} gives in an ODE for $\Delta \rho$, which can be solved alongside~\eqref{E:PycnoclineRegion:FarField}c to give
\begin{equation}\label{E:PycnoclineRegion:Deltarho_solution}
\Delta \rho = \Delta \rho_{\in} - \Pb Z_b'(X_0) \left[1 + \tanh(\zeta)\right].
\end{equation} 

Note that on the $\order{1}$ length scale, the effect of the pycnocline is to rapidly change each of the dependent variables. Thus, the \textit{change} in dependent variables across the pycnocline is the most important information to glean from the analysis in this section. With this in mind, we note that the solution~\eqref{E:PycnoclineRegion:Deltarho_solution} gives
\begin{equation}\label{E:PycnoclineRegion:Deltarho_limit}
\Delta \rho \to \Delta \rho_{\in} - 2 \Pb Z_b'(X_0)  \eqcolon \Delta \rho_\out,
\end{equation}
as $\zeta \to \infty$, i.e. the buoyancy deficit experiences a change
\begin{equation}\label{E:PycnoclineRegion:Deltarho_change}
\left[\Delta \rho\right]_{\text{pyc}} = \Delta \rho_\out - \Delta \rho_\in = - 2 \Pb Z_b'(X_0) < 0
\end{equation}
across the pycnocline. Expression~\eqref{E:PycnoclineRegion:Deltarho_change} elucidates our presentation of $\Pb$ in \S\ref{S:Model:NonDim} as a key parametric control on changes in buoyancy across the pycnocline.

For the velocity $U$, we first combine~\eqref{E:PycnoclineRegion:Mom},~\eqref{E:PycnoclineRegion:Q_conserved}, and~\eqref{E:PycnoclineRegion:Deltarho_solution} to give an ODE, 
\begin{equation}\label{E:PycnoclineRegion:U_ODE}
\cone Q_\in U \dd{U}{\zeta} = Q_\in Z_b'(X_0)\left\{\Delta \rho_\in - \Pb Z_b'(X_0) \left[1 + \tanh(\zeta)\right]\right\} - U^3.
\end{equation}
Unfortunately,~\eqref{E:PycnoclineRegion:U_ODE} cannot be solved analytically. However, for $\zeta \gg 1$ it can be approximated by
\begin{equation}\label{E:PycnoclineRegion:U_ODE_farfield}
\cone Q_\in U \dd{U}{\zeta} = Q_\in Z_b'(X_0)\Delta \rho_\out - U^3,
\end{equation}
which has a single fixed point 
\begin{equation}\label{E:PycnoclineRegion:U_Limit}
U = \left[ Q_\in Z_b'(X_0)\Delta \rho_\out\right]^{1/3}  \eqcolon U_\out.
\end{equation}
Noting that $\mathrm{d}U/\mathrm{d}\zeta > 0$  for $U < U_\out$ and $\mathrm{d}U/\mathrm{d}\zeta < 0$  for $U > U_\out$ in~\eqref{E:PycnoclineRegion:U_ODE_farfield}, we deduce that this fixed point is globally stable; the solution to~\eqref{E:PycnoclineRegion:U_ODE} therefore has $U \to U_\out$ as $\zeta \to \infty$ (figure~\ref{fig:PycnoclineAsymptotics}b). The change in plume velocity across the pycnocline is
\begin{equation}\label{E:PycnoclineRegion:U_change}
\left[U\right]_{\text{pyc}} = U_\out - U_\in = \left[Q_\in Z_b'(X_0)\right]^{1/3} \left(\Delta \rho_\out^{1/3} - \Delta \rho_\in^{1/3}\right) < 0,
\end{equation}
where the sign of the inequality comes from~\eqref{E:PycnoclineRegion:Deltarho_change}. Mass conservation~\eqref{E:PycnoclineRegion:Q_conserved} gives the corresponding change in plume thickness,
\begin{equation}\label{E:PycnoclineRegion:D_change}
\left[D\right]_{\text{pyc}} = Q_\in \left(\frac{1}{U_\out} - \frac{1}{U_\in}\right) > 0.
\end{equation}

%take-aways for thermal driving
The thermal driving behaves similarly to the velocity: inserting~\eqref{E:PycnoclineRegion:Q_conserved} into~\eqref{E:PycnoclineRegion:Themal} gives the ODE (which is coupled to~\eqref{E:PycnoclineRegion:U_ODE})
\begin{equation}\label{E:PycnoclineRegion:DeltaT_ODE}
\ctwo Q_\in \dd{\Delta T}{\zeta} = \left\{1 - Z_b(X_0) - \Pt\left[1 + \tanh(\zeta)\right]\right\}UZ_b'(X_0) - U\Delta T - Q_\in Z_b'(X_0), 
\end{equation}
which must also be solved numerically. For $\zeta \gg 1$,~\eqref{E:PycnoclineRegion:DeltaT_ODE} has a single fixed point,
\begin{equation}\label{E:PycnoclineRegion:DeltaT_Limit}
\Delta T = \frac{1}{U_\out}\left\{\left[1 - Z_b(X_0) - 2\Pt\right]U_\out Z_b'(X_0) - Q_\in Z_b'(X_0)\right\} \eqcolon \Delta T_\out.
\end{equation}
Using the same argument as above, we conclude that this fixed point is also globally stable, and thus $\Delta T \to \Delta T_\out$ as $\zeta \to \infty$ (figure~\ref{fig:PycnoclineAsymptotics}c); the thermal driving changes across the pycnocline by an amount 
\begin{equation}\label{E:PycnoclineRegion:DeltaT_change}
\left[T\right]_{\text{pyc}} = \Delta T_\out - \Delta T_\in < 0.
\end{equation} 


\begin{figure}
\centering
\includegraphics[width = 0.99\textwidth]{./figures/fig4_pycnocline_region}
\caption{Comparison between numerical solutions of the plume equations rescaled to the pycnocline (equations~\eqref{E:PycnoclineRegion:MassFull}--\eqref{E:PycnoclineRegion:ThermalFull}) and their leading order reduction (equations~\eqref{E:PycnoclineRegion:Mass}--\eqref{E:PycnoclineRegion:Themal}). We show (a) plume speed $U$, (b) buoyancy deficit $\Delta \rho$, and (c) thermal driving $\Delta T$. Purple curves correspond to the full equations with $\epsone = 3\times10^{-2}, ~\lt = 5\times10^{-3}$ (i.e. as in table~\ref{T:Dimensionless_Parameters}) and green curves correspond to the leading order equations with $\epsone = 3\times10^{-3},~ \lt = 5\times10^{-4}$ (i.e. both asymptotic parameters reduced by a factor of ten, thus preserving their ratio). Black dashed curves correspond the solution of the leading order equations~\eqref{E:PycnoclineRegion:Mass}--\eqref{E:PycnoclineRegion:Themal}. Also plotted as grey dashed lines are the quantities $f_{\in}$ and $f_{\out}$, for $f = U,~ \Delta \rho, ~\Delta T$ as appropriate (defined in the main text). Solutions here use a constant ice shelf basal slope, $Z_b(X) = X$ and $c_1, c_2, k_3,k_4, \lambda$ have the values listed in table~\ref{T:Dimensionless_Parameters}. The coloured boxes indicate a length $4 \zeta$ across which the majority of the change around $\zeta = 0 $ occurs.}\label{fig:PycnoclineAsymptotics}
\end{figure}


The sign of the `jump conditions'~\eqref{E:PycnoclineRegion:Deltarho_change},~\eqref{E:PycnoclineRegion:U_change},~\eqref{E:PycnoclineRegion:D_change}, and~\eqref{E:PycnoclineRegion:DeltaT_change} are in qualitative agreement with the example solution presented in \S\ref{S:ExampleSolutions}. To go beyond this qualitative comparison, we present in figure~\ref{fig:PycnoclineAsymptotics} a comparison between numerical solutions of \eqref{E:PycnoclineRegion:MassFull}--\eqref{E:PycnoclineRegion:ThermalFull} and solutions of the corresponding leading order equations~\eqref{E:PycnoclineRegion:Mass}--\eqref{E:PycnoclineRegion:Themal}  (for $U$ and $\Delta T$, this is the numerical solution of~\eqref{E:PycnoclineRegion:U_ODE} and~\eqref{E:PycnoclineRegion:DeltaT_ODE}, respectively, and for $\Delta \rho$, this is the solution~\eqref{E:PycnoclineRegion:Deltarho_solution}). Solutions of the leading order equations show good agreement with the full equations, albeit with a drift at larger $\zeta$ that is primarily the result of variations on the outer variable length scale, and a discrepancy at large negative $\zeta$ that results from applying  initial conditions at $\zeta = -\zeta_0$ rather than $\zeta = -\infty$. Most importantly, the jump conditions~\eqref{E:PycnoclineRegion:Deltarho_change},~\eqref{E:PycnoclineRegion:Deltarho_change}, and~\eqref{E:PycnoclineRegion:DeltaT_change} do an excellent job at predicting the change in the dependent variables in the region around $\zeta = 0$.

%These solutions demonstrate that for the typical values of the asymptotic parameters values listed in table~\ref{T:Dimensionless_Parameters} (purple curves in Figure~\ref{fig:PycnoclineAsymptotics}), solutions of the leading order equations agree reasonably well with solutions of the `full' equations, albeit with a drift at larger $\zeta$ that is primarily the result of variations on the outer variable length scale, and a discrepancy at large negative $\zeta$ that results from applying  initial conditions at $\zeta = -\zeta_0$ rather than $\zeta = -\infty$. (Note that for smaller values of the asymptotic parameters, the leading order solutions -- green curves in figure~\ref{fig:PycnoclineAsymptotics} -- agree very well with numerical solutions.) As discussed, however, we are primarily interested in the \textit{change} in dependent variables across the pycnocline; the `jump conditions'~\eqref{E:PycnoclineRegion:Deltarho_change},~\eqref{E:PycnoclineRegion:Deltarho_change}, and~\eqref{E:PycnoclineRegion:DeltaT_change} do an excellent job at predicting the change in the quantities in the region around $\zeta = 0$.
%summary 
%In summary, at leading order, flux is conserved across the pycnocline whilst the buoyancy deficit, plume velocity, plume thickness, and thermal driving experience a smooth transition between input and output values, with the difference between these values are given by~\eqref{E:PycnoclineRegion:Deltarho_change},~\eqref{E:PycnoclineRegion:U_change},~\eqref{E:PycnoclineRegion:D_change}, and~\eqref{E:PycnoclineRegion:DeltaT_change}, respectively. We shall return to these expressions when constructing the analytic melt rate in \S\ref{S:MeltRate}.

%solutions aren't valid when \Delta \rho_{\in} < 2 \Pb Z_b'(Z_0)
Before moving on to analyze the  region above the pycnocline, we note that the results of this section are only valid provided that $\Delta \rho$ remains $\order{1}$ throughout. In particular, this means that if $\Delta \rho_{\in} < 2 \Pb Z_b'(X_0)$ (see equation~\eqref{E:PycnoclineRegion:Deltarho_solution}) the analysis will break down and a sub-layer, within the pycnocline, is needed to proceed. This analysis is similar to that presented in \S\ref{S:Asymptotics:Region4} so we do not discuss it further here, other than to note that it would indicate that the plume speed reaches zero within the pycnocline, and the plume therefore detaches from the ice shelf base. This scenario may be expected to occur if the salinity stratification is particularly strong (high $\Pb$) or if the pycnocline is high in the water column (the buoyancy deficit has reduced significantly in region one, resulting in low $\Delta \rho_{\in}$). Using typical parameter values for Antarctica, we do not expect separation within the pycnocline to be predicted by the plume model considered here (see \S\ref{S:ExampleSolutions}), but note that observations in this region commonly point towards the presence of meltwater within the pycnocline. This is consistent with the picture presented earlier of progressive detrainment from the plume into the stratified ambient, which is not included in our model. For ice shelves in Greenland, however, where shelf bases are typically much steeper than in Antarctica and subglacial discharge may be significant, plumes have been observed to intrude into the ambient layer within the pycnocline~\citep{Straneo2011NatureGeo}. We speculate that, but do not investigate further, the criterion $\Delta \rho_\out < 0$  may be able to predict whether a plume will separate from the ice shelf base within the pycnocline or not.

\subsection{Region three: above the pycnocline}\label{S:Asymptotics:Region3}
We now turn to the region above the pycnocline, referred to as region three, where $X > X_0$ and $X = \order{1}$. The the leading order equations in this region read
\begin{align}
 (DU)' &= U Z_b',\label{E:Region3:mass}\\
0 &= D \Delta \rho Z_b' - U^2, \label{E:Region3:mom}\\
(DU\Delta \rho)'  &=\lambda U \Delta T\label{E:Region3:buoyancy}\\
0&= (1  - 2\Pt -  Z_b)Z_b'U- U\Delta T - DU Z_b'.\label{E:Region3:thermal}
\end{align}
The system~\eqref{E:Region3:mass}--\eqref{E:Region3:thermal} is almost identical to~\eqref{E:Region1:mass}--\eqref{E:Region1:thermal}, the leading order equations in region one: buoyancy balances drag in the momentum equation, mass flux is driven solely by entrainment, and buoyancy variations are controlled by melting only. However, conservation of thermal driving~\eqref{E:Region3:thermal} reflects a different ambient temperature to~\eqref{E:Region1:thermal}, resulting from having crossed the pycnocline.

Equations~\eqref{E:Region3:mass}--\eqref{E:Region3:thermal} are to be solved for $X > X_0$, alongside a boundary conditions obtained by matching to region two:
\begin{equation}\label{E:Region3:MatchingConditions}
U = U_\out, \quad D = \frac{Q_\in}{U_\out}, \quad \Delta \rho = \Delta \rho_\out, \quad \Delta T = \Delta T_\out,
\end{equation}
at $X = X_0$. 

We proceed as in \S\ref{S:Asymptotics:Region1}: from~\eqref{E:Region3:mass}, the flux $Q$ and velocity $U$ are again related by
\begin{equation}\label{E:Region3:U_Q_relation}
U = \frac{Q'}{Z_b'},
\end{equation}
which, when combined with~\eqref{E:Region3:mom}--\eqref{E:Region3:thermal}, gives a second order ODE for $Q$. Integrating this ODE once alongside~\eqref{E:Region3:MatchingConditions} gives
\begin{equation}\label{E:Region3:Q_ODE}
\left(Q'\right)^3 =\lambda \left(Z_b'\right)^4 \left\{\left(1 - Z_b\right)Q - 2\Pt\left(Q - Q_\in\right) -\left[1 - Z_b(X_0)\right]Q_\in\right\} + \frac{U_\out^3}{Z_b'(X_0)}\left(Z_b'\right)^4.
\end{equation}

%can't solve this numerically
Unlike~\eqref{E:Region1:flux_ODE} -- the corresponding ODE for region one -- equation~\eqref{E:Region3:Q_ODE} cannot be solved exactly; it is not possible to express the leading order contribution to the melt rate analytically in region three. Whilst this is problematic for constructing an approximation to the melt rate, we describe one possible workaround in \S\ref{S:MeltRate}. 

This workaround exploits the information that we can glean from~\eqref{E:Region3:Q_ODE}. Firstly, we note that since $Q_\in, ~U_\out >0$, and $Q = Q_\in$ at $X = X_0$, then $Q'(X_0) > 0$. Hence, $Q > Q_\in$ in some region around $X_0$; continuing this argument, we conclude that  $Q'(X)> 0$ in region three (this argument will break down when $Z_b(X) \to 1$, but this is beyond the depth of a typical ice shelf base, as discussed in \S\ref{S:Model}). The flux $Q$ will continue to increase until it reaches a critical point $X = X_c$, where $Q' \to 0$. From~\eqref{E:Region3:Q_ODE}, we see that the flux $ Q_c =Q(X_c)$ at this point satisfies 
\begin{equation}
\left[1 - Z_b(X_c)\right]Q_c - 2\Pt\left(Q_c - Q_\in\right) -\left[1 - Z_b(X_0)\right]Q_\in +  \frac{U_\out^3}{\lambda Z_b'(X_0)} = 0.
\end{equation}

Secondly, understanding the asymptotic behaviour as $X \to X_c$ also useful. From~\eqref{E:Region3:U_Q_relation}, we see that $U \to 0$ in this limit, and our assumption that $U = \order{1}$ therefore breaks down. To proceed beyond this point a rescaling of the model equations to reflect a change in asymptotic order is required. We show in appendix~\ref{A:FluxODERegion3} that the dependent variables have the following behaviour in the limit $X \to X_c$:
\begin{align}
U &\sim \lambda^{1/3} Z_b'(X_c)^{2/3} Q_c^{1/3}(X_c - X)^{1/3}, & D &\sim \lambda^{-1/3} Z_b'(X_c)^{-2/3} Q_c^{2/3}(X_c - X)^{-1/3},\label{E:Region3:X_to_Xc1}\\
\Delta \rho &\sim  \lambda Z_b'(X_c) (X_c - X), & \Delta T &\sim -\lambda^{-1/3} Z_b'(X_c)^{1/3} Q_c^{2/3}(X_c - X)^{-1/3}\label{E:Region3:X_to_Xc2}
\end{align}
These will also form the matching conditions on the region around $X_c$, which we turn to now.

%Before moving on to analyse Region 5, we note that, as we shall see in \S\ref{S:Numerics}, the point $X_c$ is only located below sea level (where it is physically relevant) in ice shelves with uncommon parameters -- corresponding to very deep grounding lines or very cold ambient conditions, for example. We shall also see that the melt rate is small ($\order{\epsone}$) for $X \gtrsim X_c$: the behaviour above $X_c$ is not important for the leading order melt rate. However, we include the analysis for completeness, because of its relevance to other physical systems in which thin flows experience a competition between buoyancy and drag (such as Katabatic winds), and because the results of the analysis have implications for the 'layered-plume' hypothesis proposed by~\cite{Magorrian2016JGeoResOcean}. 


\subsection{Region four: stopping region}\label{S:Asymptotics:Region4}
The analysis of the previous section breaks down as $X \to X_c$, where $U \to 0$. To analyze the behaviour around $X = X_c$, referred to as the `stopping region', we introduce the rescaled spatial variable $\chi$. The appropriate spatial scaling for a dominant balance in~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} is achieved by setting 
\begin{equation}\label{E:Region4:X_scaling}
X = X_c + \epsone^{3/4}\chi,
\end{equation}
where $\chi = \order{1}$, and introducing scaled variables
\begin{equation}\label{E:Region4:var_scaling}
U = \epsone^{1/4}u, \quad D = \epsone^{-1/4}d, \quad \Delta \rho = \epsone^{3/4}\p, \quad  \Delta T = \epsone^{-1/4} \t.
\end{equation}

Inserting~\eqref{E:Region4:X_scaling}--\eqref{E:Region4:var_scaling} into the model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}, and retaining only leading order terms gives
\begin{align}
\dd{(du)}{\chi} &=0,\label{E:Region4:mass_scaled}\\
\dd{(du^2)}{\chi} &=  d \p Z_b'(X_c) -u^2,\label{E:Region4:mom_scaled}\\
\dd{(du\p)}{\chi} &=\lambda  u\t,\label{E:Region4:buoyancy_scaled}\\
k_2 \dd{(du \t)}{\chi} &=- u \t - du Z_b'(X_c).\label{E:Region4:thermal_scaled}
\end{align}

Matching with region three (see~\eqref{E:Region3:X_to_Xc1}--\eqref{E:Region3:X_to_Xc2}) requires that the solution to~\eqref{E:Region4:mass_scaled}--\eqref{E:Region4:thermal_scaled} satisfies
\begin{align}
u &\sim \lambda^{1/3}Z_b'(X_c)^{-2/3}Q_c^{1/3} \chi^{1/3}, &  d &\sim \lambda^{-1/3} Z_b'(X_c)^{-2/3} Q_c^{2/3}\chi^{-1/3}\label{E:Region4:far_field1},\\
\p &\sim  \lambda Z_b'(X_c) \chi, & \t &\sim -\lambda^{-1/3} Z_b'(X_c)^{1/3} Q_c^{2/3}\chi^{-1/3}\label{E:Region4:far_field2}
\end{align}
as $\chi \to -\infty$. (Again, numerical solutions of~\eqref{E:Region4:mass_scaled}--\eqref{E:Region4:thermal_scaled} are obtained on a restricted domain $-\chi_0 < \chi < \chi_0$ where $|\chi_0| \ll \epsone^{3/4}$.)

We begin by noting that flux is again conserved,
\begin{equation}\label{E:Region4:Constant_Flux}
du  = Q_c.
\end{equation}
Inserting~\eqref{E:Region4:Constant_Flux} into~\eqref{E:Region4:thermal_scaled} and combining with~\eqref{E:Region4:buoyancy_scaled} gives a expression that can be directly integrated once alongside~\eqref{E:Region4:far_field2} to give
\begin{equation}\label{E:Region4:Linear_p_t}
\frac{\p}{\lambda} + k_2 \t = -Z_b'(X_c)\chi.
\end{equation}

The relationships~\eqref{E:Region4:Constant_Flux} and~\eqref{E:Region4:Linear_p_t} allow us to reduce~\eqref{E:Region4:mass_scaled}--\eqref{E:Region4:thermal_scaled} to a system of two equations, which can be rescaled so that only a single parameter, $k_2 \lambda$, enters:
\begin{align}
\tilde{u} \dd{\tilde{u}}{\tilde{\chi}} = \tilde{\p} - \tilde{u}^3,\label{E:Region4:rescaled1}\\
k_2 \lambda \dd{\tilde{\p}}{\tilde{\chi}} = -\tilde{u}\left[\tilde{p} + \tilde{\chi}\right],\label{E:Region4:rescaled2}
\end{align}
where
\begin{equation}\label{E:Region4:Rescaling}
\tilde{\chi} = \frac{\lambda^{1/4}Z_b'(X_c)^{1/2}}{Q_c^{1/2}}\chi, ~\quad  \tilde{u} = \frac{1}{\lambda^{1/4}Z_b'(X_c)Q_c^{1/2}}u,\quad \tilde{\p}= \frac{1}{\lambda^{3/4}Z_b'(X_c)Q_c^{1/2}}\p.
\end{equation} 
In terms of these rescaled variables, the matching conditions conditions~\eqref{E:Region4:far_field1}--\eqref{E:Region4:far_field2} read
\begin{equation}\label{E:Region4:Rescaled_farfield}
\tilde{\p} \sim -\tilde{\chi},~ \tilde{u}\sim (-\tilde{\chi})^{1/3}\quad \text{as}~\tilde{\chi}\to -\infty.
\end{equation}


\begin{figure}
\centering
\includegraphics[width = 0.95\textwidth]{./figures/fig5_transition_region_both.pdf}
\caption{Numerical solutions of the stopping region equations (original model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} rescaled according to~\eqref{E:Region4:X_scaling}--\eqref{E:Region4:var_scaling} and~\eqref{E:Region4:Rescaling}) with $\epsone = 3\times 10^{-2}$ (i.e. as in table~\ref{T:Dimensionless_Parameters}, purple curves) and with $\epsone = 3\times 10^{-3}$ (green curves) which are shown in (a) $(\tilde{u}, \tilde{\p})$ space and (b) $(\tilde{\chi}, \tilde{\p})$ space. The black dashed curve indicates the numerical solution of~\eqref{E:Region4:rescaled1}--\eqref{E:Region4:rescaled2}, the grey curve indicates the nullcline $\tilde{u}^3 = \tilde{\p}$, and the solid black indicates line $\tilde{p} = 0$ Each of the solutions here uses a linear draft, $Z_b(X) = X$, with $Q_c = 0.5, X_c = 0.5$ and $\lambda, k_i$ according to the values in table~\ref{T:Dimensionless_Parameters}. The matching conditions~\eqref{E:Region4:far_field1}--\eqref{E:Region4:far_field2} are applied at $\tilde{\chi}_0 = 10$ in both cases. }\label{fig:Region4}
\end{figure}

The system~\eqref{E:Region4:rescaled1}--\eqref{E:Region4:Rescaled_farfield} must be solved numerically. In figure~\ref{fig:Region4}, we present a comparison between numerical solutions of the reduced equations~\eqref{E:Region4:rescaled1}--\eqref{E:Region4:Rescaled_farfield} and the solutions of the full equations (model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal} rescaled according to~\eqref{E:Region4:X_scaling}--\eqref{E:Region4:var_scaling}). We see good agreement, with solutions predominantly following the nullcline $\tilde{\p} = \tilde{u}^3$ but deviate from it when the rescaled buoyancy deficit $\tilde{\p}$ approaches zero. The buoyancy deficit goes negative, indicating that the plume has become negatively buoyant; the plume's upward motion continues for a short distance because of its inertia, before ultimately reaching $\tilde{u} = 0$ where it terminates. For the purpose of constructing an approximation to the melt rate, it is worth noting that the rescaled pressure is approximately linear (figure~\ref{fig:Region4}b); using this, the nullcline solution for $\tilde{u}$, which holds nearly everywhere in this regions, can be approximated by $\tilde{u} = \tilde{\chi}^{1/3}$.




\section{Approximating the melt rate}\label{S:MeltRate}
In this section, we describe our analytic approximation $M_p(X)$ to the melt rate $M(X) = U(X)\Delta T(X)$ that emerges from the model equations~\eqref{E:NonDim:mass}--\eqref{E:NonDim:thermal}. This approximation builds upon the asymptotic analysis of the previous section, and we deal with each of the four regions identified in \S\ref{S:Asymptotics} in turn.

\subsection{Region one}
Recall that in region one, the solution to the leading order equations can be expressed analytically. $M_p$ therefore takes values specified by the corresponding leading order contribution to $U\Delta T$:
\begin{multline}\label{E:MeltRate:region1}
M_{p} = M_{p,1}(X) \coloneqq - Z_b'(X)\left\{\frac{2}{3}\int_0^X \lambda^{1/3}\left[Z_b'(\xi)\right]^{4/3}\left[1 - Z_b(\xi)\right]^{1/3}~\mathrm{d}\xi\right\}^{3/2} + \\
\left(\frac{2\lambda}{3}\right)^{1/2}\left[Z_b'(X)\right]^{4/3}\left[1 - Z_b(X)\right]^{4/3} \left\{\int_0^X \left[Z_b'(\xi)\right]^{4/3}\left[1 - Z_b(\xi)\right]^{1/3}~\mathrm{d}\xi\right\}^{1/2},
\end{multline}
in $0 < X < X_0 - N_l \lt $. \red{Check that this expression agrees with earlier solution in S3.1} Here $N_l = \order{1}$ is introduced to account for the finite extent of the pycnocline: we define the pycnocline region in our the approximation constructed here as $X_0 - N_l \lt < X < X_0 + N_l \lt$, i.e. the quantity $2 N_l$ describes the number of (dimensionless) pycnocline length scales required for the solution to transition between the constant values of the velocity and thermal driving on either side of the pycnocline.  We must make a choice for $N_l$; in what follows we take $N_l = 2$, a choice that is informed by the solutions of equations~\eqref{E:PycnoclineRegion:MassFull}--\eqref{E:PycnoclineRegion:ThermalFull} shown in figure~\ref{fig:PycnoclineAsymptotics}. There it can be seen that the majority of the rapid change close to the centre of the pycnocline occurs over a length bounded by four dimensionless pycnocline length scales (the light blue boxes in figure~\ref{fig:PycnoclineAsymptotics} have height $4\lt$, when measured in terms of the outer variable $X$).

As discussed, the integrals in~\eqref{E:MeltRate:region1} must be evaluated numerically in general, but accurate analytic approximations can be made provided that the ice shelf basal geometry is known. In the case that the ice shelf base has a constant slope, the approximation~\eqref{E:MeltRate:region1} reduces to the solution described by~\cite{Lazeroms2019JPhysOcean}:
\begin{equation}\label{E:MeltRate:LazeromsMelt}
M_{\text{L19}}(X) = \frac{\lambda^{1/2}}{2\sqrt{2}}\left[1 - (1 - X)^{4/3}\right]^{1/2}\left[3(1-X)^{4/3} - 1\right].
\end{equation}
We henceforth refer to the dimensional form of~\eqref{E:MeltRate:LazeromsMelt} as the `L19 approximation'. 

\cite{Lazeroms2019JPhysOcean} also describe an ad-hoc method to account non-constant basal slopes, which involves with simply replacing all factors of the aspect ratio in the L19 approximation by the local slope of the ice shelf base. This method is essentially equivalent to multiplying~\eqref{E:MeltRate:LazeromsMelt} by a factor of $Z_b'(X)^{3/2}$; the corresponding approximation to the melt rate is
\begin{equation}\label{E:MeltRate:LazeromsMelt_adhoc}
M_{\text{L19AH}}(X) =Z_b'(X)^{3/2} \frac{\lambda^{1/2}}{2\sqrt{2}}\left[1 - (1 - X)^{4/3}\right]^{1/2}\left\{2(1-X)^{4/3} - \left[1- (1 - X)^{4/3}\right]\right\}.
\end{equation}
The dimensional form of~\eqref{E:MeltRate:LazeromsMelt_adhoc} is referred to as the `L19AH approximation' henceforth. \cite{Lazeroms2019JPhysOcean} demonstrated that (and we show in \S\ref{S:Numerics}), this simple method of accounting for a non-constant slope does a good job. 

The two-dimensional extensions of the L19 and L19AH approximations represent the current state of the art in plume-physics based melt rate parametrizations; these approximations therefore represent the benchmark against which we shall test the approximation constructed in this section.

\subsection{Region two}
Unlike in region one, we do not have an analytic solution to the appropriate leading order equations in region two. We therefore construct our approximation based on expressions~\eqref{E:PycnoclineRegion:U_change} and~\eqref{E:PycnoclineRegion:DeltaT_ODE} for the change in $U$ and $\Delta T$ across a relatively slender pycnocline: we linearly interpolate according to these values, giving
\begin{equation}\label{E:MeltRate:regions2}
M_{p} = M_{p,2}(X) \coloneqq \left[U_{\out} + \left[U\right]_{\text{pyc}} \frac{X - (X_0 + N_l \lt)}{2N_l \lt}\right]  \left[\Delta T_{\out} +  \left[\Delta T\right]_{\text{pyc}} \frac{X - (X_0 + N_l \lt)}{2N_l \lt}\right] , 
\end{equation}
for $ X_0 - N_l \lt  < X < X_0 + N_l \lt$. (Recall that $U_\out$, $\left[U\right]_{\text{pyc}}$, $\Delta T_\out$, and $\left[\Delta T\right]_{\text{pyc}}$ are set out explicitly in equations~\eqref{E:PycnoclineRegion:U_Limit}, \eqref{E:PycnoclineRegion:U_change}, \eqref{E:PycnoclineRegion:DeltaT_Limit}, and~\eqref{E:PycnoclineRegion:DeltaT_change}, respectively.) Note that if $\Delta \rho_\out < 0$, we apply~\eqref{E:MeltRate:regions2} only as far as $M_{p,2} = 0$ and take $M_{p} = 0$ downstream of this point.


\subsection{Region three}\label{S:MeltRate:R3}
Extra care must be taken for region three, owing to the dearth of information about the leading order solution in this region: our knowledge is limited to understanding that the velocity decreases until it reaches zero at an a priori unknown point $X_c$, and a description of the behaviour of solutions close to $X_c$ (in particular, we saw that $U \sim (X_c - X)^{1/3}$ as $X \to X_c$). In this section, we describe a way to construct an appropriate approximation to the melt rate which exploits the information available, but stress that we make several ad hoc choices, and the construction is by no means unique.

Our strategy for this the region, $X_0 + 2N_l \lt < X < X_c$, is to split it into two further regions: a lower part $X_0 + 2 N_l < X \leq X^*$ and an upper part $X^* < X < X_c$. We choose to take $X^*$ to be the point at which the velocity has decayed to some fraction $0 < f < 1$ of $U_\out$ -- the velocity of the plume when it enters region three from below -- assuming that such a point exists. We shall describe shortly how to determine $X^*$ approximately, but for the moment we assume that it is known.

For the lower part, $X_0  + 2N_l \lt < X \leq X^*$, we exploit the proximity to the pycnocline to artificially construct a small parameter and seek an asymptotic expansion of the pertinent variables in this parameter. For the upper half, $X^* < X < X_c$, we mimic the behaviour as $X \to X_c$; in doing so we are able to simultaneously describe the behaviour in this region whilst also determining the values of $X_c$ and $Q_c = Q(X_c)$.

In more detail, for the lower half we introduce 
\begin{equation}
\varepsilon = X^* - X_0,
\end{equation}
which we consider to be a small, positive parameter. We set 
\begin{equation}
X = X_0 + \varepsilon Y,
\end{equation}
where  $Y = \order{1}$, in the ODE~\eqref{E:Region3:Q_ODE} for the flux $Q$ in region three, and account for variations in $Q$ away from $Q_{\text{in}} = Q(X_0)$ by expanding in powers of $\varepsilon$:
\begin{equation}\label{E:MeltRate:Q_expansionR3}
Q = Q_{3l} \coloneqq   Q_\in  + \sum_{i = 1}^{\infty} \varepsilon^i Q_i(Y), \qquad Q_i \sim \order{1}.
 \end{equation}
Equating powers of $\varepsilon$ leads to a hierarchy of simple ODEs for the $Q_i$, which can be solved analytically in series. In Appendix~\ref{A:Expansion} we explicitly set out the ODEs that arise at $\order{1}$, $\order{\varepsilon}$, and $\order{\varepsilon^2}$; solving these equations gives, respectively,
\begin{equation}
Q_1(Y) = K_1 Y, \quad Q_2(Y) = K_2 Y^2, \quad Q_3(Y) =K_3 Y^3.
\end{equation}
Here the $K_i,~i = 1,2,3$ are known functions of $\lambda, Q_\in, U_\out, \Pt$, and $Z_b$ (these functions are stated explicitly in Appendix~\ref{A:Expansion}). 

Using the relationship~\eqref{E:Region3:U_Q_relation}, the velocity associated with~\eqref{E:MeltRate:Q_expansionR3} is
 \begin{equation}\label{E:MeltRate:U_expansionR3}
U = U_{3l} \coloneqq \frac{1}{Z_b'(X)} \sum_{i = 1}^{\infty} \varepsilon^{i-1} \dd{Q_i}{Y}.
\end{equation}

We use~\eqref{E:MeltRate:U_expansionR3} to determine $X^*$: by retaining only the first three terms in the expansion~\eqref{E:MeltRate:U_expansionR3}, and making the approximation  $Z_b'(X) \approx Z_b'(X_0)$, we see that $X^*$ must satisfy the quadratic equation
\begin{equation}\label{E:MeltRate:quadratic_for_xstar}
f U_\out = \frac{1}{Z_b'(X_0)}\left[K_1 + 2 K_2(X^* - X_0) + 3K_3(X^* - X_0)^2 \right].
\end{equation}
In what follows we take $f = 1/2$: $X^*$ is the point at which the plume speed according to~\eqref{E:MeltRate:U_expansionR3} drops to approximately one half of $U_\out$. In the case that~\eqref{E:MeltRate:quadratic_for_xstar} has no solution, we assume that the plume reaches the ice shelf front without terminating, taking $X^* = \infty$ and ignoring any further contributions to the melt rate.

Having constructed an approximation to both the flux and velocity in the lower part of region three we might now use conservation of thermal driving~\eqref{E:Region3:thermal} to determine an approximation to the melt rate there. However, since the expansion~\eqref{E:MeltRate:Q_expansionR3} only accounts for the ice shelf geometry at $X = X_0$, it may perform poorly when applied to ice shelves with significant geometric variations above the pycnocline. In lieu of an analytic method that accounts for non-constant basal slopes, we apply the same ad-hoc geometric dependence as~\citet{Lazeroms2018TheCryo}. Our approximation to melt rate therefore takes values
\begin{equation}\label{E:MeltRate:regions3_l}
M_{p}(X) = M_{p,3l}(X)\coloneqq Z_b'(X)^{5/2}\left\{\left[1  - 2\Pt -  Z_b(X)\right] U_{3l}(X) - Q_{3l}(X)\right\}
\end{equation}
for $X_0 + N_l \lt < X < X^*$.

Our construction in the upper part of region three, $X^* < X < X_c$, is motivated by the asymptotic behaviour~\eqref{E:Region3:X_to_Xc1}. Since $Q_c$, and thus the prefactor in~\eqref{E:Region3:X_to_Xc1}, are unknown, we first express the velocity in $X^* < X < X_c$ according to the asymptotic behaviour as $X\to X_c$~\eqref{E:Region3:MatchingConditions}, albeit with an arbitrary prefactor:
\begin{equation}\label{E:MeltRate:Region3u_U}
U =U_{3u} =  C (X_c - X)^{1/3},
\end{equation} 
where $C$ and $X_c$ are to be determined. Note that since the solution in region four can be approximated by a solution of the form~\eqref{E:MeltRate:Region3u_U} (see discussion at the end of \S\ref{S:Asymptotics:Region4}), the below is also considered to be appropriate for region four.

Now, if we assert that the velocity must be continuously differentiable across $X^*$, then $C$ and $X_c$ are uniquely determined using~\eqref{E:MeltRate:U_expansionR3} and~\eqref{E:MeltRate:Region3u_U} as
\begin{equation}\label{E:MeltRate:Xc_expression}
X_c = X^* + \frac{U_{3l}(X^*)}{3 U_{3l}'(X^*)}, \qquad C = \frac{U_{3l}(X^*)}{\left(X_c - X^*\right)^{1/3}}
\end{equation}
In the case that this procedure gives $X_c < X^*$ (i.e. if $U_{3,l}'(X_c) > 0$), we again set $X^* = \infty$.

Our approximation to the melt rate in $X^* < X <X_c$ is then constructed using~\eqref{E:Region3:thermal} and applying the ad-hoc geometric dependence:
\begin{equation}\label{E:MeltRate:regions3_u}
M_p(X) = M_{p,3u}(X) \coloneqq Z_b'(X)^{5/2}\left\{ \left[1  - 2\Pt -  Z_b(X)\right] U_{3u}(X) - Q_{3l}(X^*) \right\}
\end{equation}
for $X^* < X < X_c$. Note that here we have approximated the flux $Q$ in $X^* < X < X_c$ by $Q_{3l}(X^*)$, motivated by the fact that the flux is constant as $X \to X_c$ from~\eqref{E:Region4:Constant_Flux}.

In summary, our approximation to the dimensionless melt rate takes values
\begin{equation}\label{E:MeltRate:AllRegions}
M_{p}(X) = \begin{cases} 
M_{p,1}(X) \text{~~\quad [equation~\eqref{E:MeltRate:region1}]}  & 0 < X < X_0 - N_l \lt,\\
M_{p,2}(X) \text{~~\quad [equation~\eqref{E:MeltRate:regions2}]} & X_0 - N_l \lt < X < X_0 + N_l \lt,\\
M_{p,3l}(X) \text{~\quad [equation~\eqref{E:MeltRate:regions3_l}]} & X_0 + N_l \lt < X < X^*,\\
M_{p,3u}(X) \text{\quad [equation~\eqref{E:MeltRate:regions3_u}]} & X^* < X < X_c.
\end{cases}
\end{equation}
(The corresponding constructions for the exception cases discussed are presented in Appendix\ref{A:ExceptionCases}.)

Our approximation to the dimensional melt rate is obtained by undoing the various scalings:
\begin{equation}\label{E:MeltRate:DimensionalMelt}
\dot{m} =\left(\frac{\beta_S S_l g \tau^3 E_0^3 \alpha^3}{\lambda_3 C_d (L/c)^3}\right)^{1/2} M_p\left(\frac{\lambda_3 \alpha X}{\tau}\right),
\end{equation}
where the $X$ in the argument of $M_p$ is dimensional. We henceforth refer to~\eqref{E:MeltRate:DimensionalMelt} as the `B21 approximation'.


\section{Performance of approximation}\label{S:Numerics}
In this final section, we assess the performance of the approximation~\eqref{E:MeltRate:DimensionalMelt} by comparing it to the melt rate obtained by  numerically solving the full equations~\eqref{E:Modelling:Model:Mass}--\eqref{E:Modelling:Model:Thermal}. We also compare our approximation to both the L19 and L19AH approximations; our assessment of its performance is based not only on agreement with numerical solutions but also upon improving on the L19 and L19AH approximations. These comparisons are presented in dimensional form for consistency with the literature on basal melt rates under ice shelves.

In theory, we have made two improvements upon the L19 and L19AH approximations: (i) accounting for a general ice shelf basal geometry and capturing non-local geometric effects, and (ii) accounting for stratification in the ambient salinity and temperature. We first consider both of these improvements in isolation, making the aforementioned comparison for different ice shelf basal geometries with constant ambient conditions and, then, for a constant basal slope and different pycnocline positions. Following this, we combine the two, and assess the performance of our approximation in geometries with a non-constant basal slope and ambient stratification.

\subsection{Isolating Basal Geometry}\label{S:Numerics:NoPycnocline}
\begin{figure}
\centering
\includegraphics[width = 0.9\textwidth]{./figures/fig6_isolating_geometry}
\caption{Comparison between numerically obtained melt rates $\dot{m}= M_0 U \Delta T$ (purple curves) and the three approximations: B21 (green curves), L19AH (orange curves), and L19 (black dashed curves). Each subplot corresponds to a different ice shelf basal geometry as follows (shown schematically in the insets): (a) linear ($Z_b(X) = \alpha X$), (b) quadratic (equation~\eqref{E:Numerics:QuadraticGeometry}), (c) linear with periodic oscillations superimposed (equation~\eqref{E:Numerics:SinusoidalGeometry}), and (d) piecewise linear (equation~\eqref{E:Numerics:PiecewiseGeometry}). Note that the three approximations to the melt rate are identical for the constant basal slope case in (a).  Here we use parameter values as in table~\ref{T:Constants}, except for imposing a constant ambient temperature and salinity, which we take as $ 0.5\si{\celsius}$ and $34.3~\text{PSU}$, respectively. Note that the upper limit of each the plots, $Z + Z_{gl} = 0$, corresponds to sea level, which acts as an upper bound on the extent of the ice shelf base.}   \label{fig:Numerics:Geometry}
\end{figure}

In figure~\ref{fig:Numerics:Geometry}, we present a comparison between numerically obtained melt rates and the three approximations for several different basal geometries and constant ambient conditions. For the BW21 approximation, this unstratified case is recovered by setting $X_0 = \infty$ in~\eqref{E:MeltRate:DimensionalMelt}. This constant ambient scenario may also be pertinent if the pycnocline is below the level of the grounding line, or if an obstacle such as a sea-bed ridge obscures access of the warm, salty lower layer to the ice front, as has been observed to occur in the Pine Island Glacier~\citep{DeRydt2014JGeophysResOceans}. 

%talk about each of the drafts in question]
In the case of a constant slope base (figure~\ref{fig:Numerics:Geometry}a), the melt rates display the characteristic behaviour associated with subglacial plumes that were described in \S\ref{S:ExampleSolutions}: the melt rate increases from the grounding line, reaching a maximum several hundreds of metres downstream, before decreasing towards zero. For the ambient temperature used in the data shown in figure~\ref{fig:Numerics:Geometry}a, the thermal driving is strong and thus the melt rates remain positive. Each of the three approximations are identical when the ice shelf base has a constant slope, and show good agreement with the numerical solution.

The pattern of melt rates is broadly similar for the quadratic profile (figure~\ref{fig:Numerics:Geometry}b) given by
\begin{equation}\label{E:Numerics:QuadraticGeometry}
\frac{Z_b(X)}{\left[Z\right]}= \frac{X}{\left[X\right]} - \frac{1}{2}\left(\frac{X}{\left[X\right]}\right)^2,
\end{equation}
albeit that the maximum melt rate is reduced, and the peak melt rate occurs closer to the grounding line. (This geometry can be thought of as typical of one in which changes in the basal slope occur on the same length scale as the ice shelf.) The B21 approximation agrees well with the numerical solution throughout, while the L19AH parametrization agrees well with numerical solutions close to the grounding line, but deviates closer to the ocean surface; errors in the L19AH approximation increase in $Z$, which is indicative of the accumulation of errors that results from consideration only of local rather than all upstream geometry. Despite this, the L19AH approximation performs significantly better than the L19 parametrization, highlighting that the ad-hoc geometric dependence used by the L19AH approximation does a good job. 

In figure~\ref{fig:Numerics:Geometry}c, we present the comparison for a linear ice shelf base with a periodic oscillation superimposed:
\begin{equation}\label{E:Numerics:SinusoidalGeometry}
\frac{Z_b(X)}{\left[Z\right]}= \frac{X}{\left[X\right]} + \frac{30}{\left[Z\right]}\sin\left(\frac{2\pi}{0.1}\frac{ X}{\left[X\right]}\right).
\end{equation}
Note that period of oscillation, and thus length scale on which basal slope changes occur, is relatively short in comparison with the length scale of the freezing point dependence (indicated by the $0.1$ in the denominator in the argument). Both the L19AH and B21 approximations accurately capture the oscillatory melt rate seen in numerical solutions, but overestimate the melt rate at troughs where the slope of the base approaches zero; in these areas, our assumption that the slope is $\order{\alpha}$ breaks down, and the relatively good agreement is therefore somewhat surprising. Unlike in the quadratic case, the L19 approximation shows good agreement throughout the water column: the errors that accumulate with depth effectively cancel out between peaks and troughs of the profile.  

Finally, in figure~\ref{fig:Numerics:Geometry}d, we present the comparison in the case of a piecewise linear ice shelf base,
\begin{equation}\label{E:Numerics:PiecewiseGeometry}
\frac{Z_b(X)}{\left[Z\right]} = \begin{cases}
  \frac{X}{\left[X\right]}  & 0 <   \frac{X}{\alpha |Z_{gl}|} \leq   \frac{1}{2},\\
   2 \left(\frac{X}{\left[X\right]} -\frac{1}{2}\right)  &  \frac{1}{2} <   \frac{X}{\alpha |Z_{gl}|} <   1.
    \end{cases}
\end{equation}
This profile has a change in slope at a depth of one-half the grounding line depth. Below the discontinuity the approximations are identical and the agreement with numerical solutions is very good. Both the L19AH and B21 approximation significantly overestimate the melt rate in the region around the discontinuity, where, again, our assumption that the basal slope is $\order{\alpha}$ breaks down. The L19 approximation does not have information about the change in geometry and significantly underestimates melt rates there. Above the discontinuity, the three approximations deviate, but the B21 approximation displays the best agreement with the numerical solution. It is worth noting that the B21 approximation also performs better than the L19AH approximation in the region just beyond the discontinuity, indicating that the former is better able to capturing the local dependence on the geometry in addition to global dependence. 

In summary, in the absence of stratification the approximation constructed in \S\ref{S:MeltRate} represents an improvement on both the L19 and L19AH approximations, on account of its ability to better capture variations in the slope of the ice shelf base both locally and non-locally. In addition, provided that the assumptions on the geometry hold, we have formally quantified the error as $\order{\epsone}$; no such constrained error exists for either the L19 or L19AH approximations. 

\subsection{Isolating Stratification}
In figure~\ref{fig:Numerics:PycnoclinePosition}, we present a comparison between numerically obtained melt rates and the approximations, for these case where two layer stratification is imposed and the basal slope is constant; in this way, we isolate the effect of ambient stratification on differences between the approximations and numerical solutions. Note that in the case of a constant basal slope the L19 and L19AH approximations are identical, and we therefore refer only to the former in this section. We use the average value of the upper and lower layer salinity and temperature as the constant values in the L19 approximation.

The parameters used in figure~\ref{fig:Numerics:PycnoclinePosition} represent three different scenarios: (a) a very deep grounding line with cold ambient conditions; (b) more typical depths and temperatures; and (c) unusually strong salinity stratification.

\begin{figure}
\centering
\includegraphics[width = 0.99\textwidth]{./figures/fig7_isolating_stratificationAll}
\caption{Comparison between numerically obtained melt rates $\dot{m}= M_0 U \Delta T$ (solid curves), the B21 approximation (coloured dashed curves) and the L19 approximation (black dashed curve), with two layer stratification and a constant basal slope. Results are shown for different pycnocline positions $Z_0$ (colours, as indicated by the legend in (a)). In each case, the parameters are as in table~\ref{T:Constants}, with the exception of (a) $Z_{gl} = -3000$, $T_l = -1$ and $T_u = -3$ and (c)  $S_u = 33.0$~PSU. Note that for the L19 approximation we take the constant ambient temperature and salinity to be the average of the values above and below the pycnocline. The panels along the left hand side of each subplot indicate that which part of the B21 approximation is appropriate at that depth (i.e. which of the regions discussed in \S\ref{S:MeltRate}), for the case of a pycnocline centred at $Z_0/\ell_0 = 0.25$.}\label{fig:Numerics:PycnoclinePosition}
\end{figure}

%comparison numerics and my melt only (a)
For cold, deep conditions (figure~\ref{fig:Numerics:PycnoclinePosition}a) we see very good agreement between numerically obtained melt rates and our B21 approximation up until well beyond the pycnocline. Far above the pycnocline,  the B21 approximation captures the broad trend of the numerical solutions, characterized by a strong refreezing before a sharp transition to zero melt when the plume terminates. The B21 approximation over-estimates the peak refreezing rate, however; the loss of accuracy at shallower depths (larger $Z + Z_{gl}$) is concomitant with errors that increase with distance from the pycnocline, as we would expect from having expanded about this point.

%comparison numerics and my melt only (b)
For a more typical grounding line depth and temperature profile (figure~\ref{fig:Numerics:PycnoclinePosition}b), the agreement between the B21 approximation and numerical solutions is very good everywhere. In contrast to the cold, deep case, the plume reaches the surface having not spent a significant distance in region three, and the errors associated with the expansion~\eqref{E:MeltRate:U_expansionR3} are thus relatively small.

Finally, for the case of unusually strong ambient salinity stratification (figure~\ref{fig:Numerics:PycnoclinePosition}c), the B21 approximation is able to capture the plume termination within the pycnocline that may occur in this case. Agreement between the B21 approximation and numerical solutions is again very good everywhere and, in particular, the B21 approximation accurately predicts the point at which the plume terminates.

Figure~\ref{fig:Numerics:PycnoclinePosition} demonstrates clearly that the B21 approximation represents an improvement on the L19 approximation when the ambient ocean has two layer stratification. The latter parametrization -- which, it should be stressed, is only designed to account for constant ambient conditions -- fails to capture the behaviour above the pycnocline: the L19 approximation significantly over-predicts the portion of the ice shelf base in which melting occurs and fails to capture the transition to refreezing.

\subsection{Including Non-planar Basal Geometry and Stratification}
\begin{figure}
\centering
\includegraphics[width = 0.99\textwidth]{figures/fig8_geometry_and_stratificationAveTScale.pdf}
\caption{Comparison between numerically obtained melt rates $\dot{m}= M_0 U \Delta T$ (purple curves), the B21 approximation (green curves) and the L19AH approximation (orange curves), with two layer stratification. Results are shown for several difference basal geometries as follows: (a) `quadratic'~\eqref{E:Numerics:QuadraticGeometry}, (b) `idealized Ross'~\eqref{E:Numerics:RealisticGeometry}, (c) `sinusoidal~\eqref{E:Numerics:SinusoidalGeometry}, and (d) `piecewise linear' ~\eqref{E:Numerics:PiecewiseGeometry} (the geometries corresponding to (a), (b) and (d) are shown schematically in the insets in figure~\ref{fig:Numerics:Geometry}(b), (c) and (d), respectively, while the geometry corresponding to (b) is shown as an inset in that plot). In each subplot, the left and right hand plots correspond a relatively deep pycnocline and relatively shallow pycnocline, respectively.  The parameters used to generate the results shown here are as in table~\ref{T:Constants}. }\label{fig:Numerics:pycnocline_and_geometry_idealized}
\end{figure}

Finally, we assess the performance of the B21 approximation in the case of a non-constant basal slope and two-layer ambient stratification. The comparison between the approximations and numerical solutions is presented in figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized} (we do not include the L19 approximation in this assessment, as it was shown in \S\ref{S:Numerics:NoPycnocline} to perform poorly for non-constant basal slopes). Here, we consider two different pycnocline positions, one relatively deep and one relatively shallow, for each of four geometries: the quadratic, sinusoidal, and piecewise linear geometries referred to earlier (shown schematically in the insets in figure~\ref{fig:Numerics:Geometry}b,c, and d, respectively), as well as a fourth geometry 
\begin{equation}\label{E:Numerics:RealisticGeometry}
\frac{Z_b(X)}{\left[Z\right]}= \frac{X}{\left[X\right]} -4.2\left(\frac{X}{\left[X\right]}\right)^2 + 12.8\left(\frac{X}{\left[X\right]}\right)^3.
\end{equation}
We refer to the geometry~\eqref{E:Numerics:RealisticGeometry} as `idealized Ross', owing to its qualitative similarity to a transect taken along flowline under the Ross Ice Shelf~\citep{Shabtaie1987JGeophysResSolidEarth}. In particular, this geometry features a flatter section in the centre of the ice shelf base and a relatively large positive slope close to its front (see inset in figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}b) .

The salient observation from this comparison is that agreement between numerical solutions and our B21 approximation is very good in both the quadratic and the idealized Ross cases, and performs significantly better than the L19AH approximation. Crucially, in these cases, the shape of the ice shelf base satisfies the assumptions made in the asymptotic analysis: their slopes remain $\order{\alpha}$ throughout, with with defined derivatives, and vary on the same scale as the length of the base. In the sinusoidal and piecewise cases, these assumptions are violated, and large differences between numerical solutions and the B21 approximation can be seen in certain regions.

In more detail, the pattern of melting in the quadratic case (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}a) with two layer stratification is very similar to that in the corresponding linear case (figure~\ref{fig:Numerics:PycnoclinePosition}): a melt rate that increasing from the grounding line to a peak just below the pycnocline if the pycnocline is deep, (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}a left), and some distance below the pycnocline if it is shallow (right), with refreezing close to the ice shelf front. These features are all captured well by the B21 approximation. The agreement above the pycnocline reinforces our assertion that the ad-hoc geometric dependence used by the B21 parametrization does a good job, provided that that geometry is not overly complex.
Although agreement is good for both pycnocline positions in the idealized Ross case (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}b), it is somewhat better in the shallow pycnocline case. In the deep case, the geometry downstream of the pycnocline is relatively complex; the over-prediction of both melting and refreezing rates above the pycnocline (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}b, left) are a consequence of both increasing errors with distance from the pycnocline and the inability of the ad-hoc method to completely capture the geometric dependence in this case. 

The sinusoidal case (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}c) demonstrates clearly how the B21 approximation may perform poorly when the geometry does not conform to the restrictions placed on it. Although agreement is good below the pycnocline (as discussed in \S\ref{S:Numerics:NoPycnocline}), this parametrization makes spurious predictions through and above the pycnocline. There are two main reasons for this: firstly, the upper edge of the discrete pycnocline region introduced in \S\ref{S:MeltRate} is located near a trough of the profile, where the slope approaches zero, resulting in large errors in the expansion~\eqref{E:MeltRate:U_expansionR3}, which has the basal slope in its denominator.  Secondly, the slope of the base changes significantly across the pycnocline, leading to an inaccurate representation of the important physics in this region (we assumed, when analyzing the pycnocline region in \S\ref{S:Asymptotics:Region3} that the ice shelf basal slope does not change significantly there).

Finally, in the piecewise linear case (figure~\ref{fig:Numerics:pycnocline_and_geometry_idealized}d), the agreement between numerical solutions and the B21 approximation is surprisingly good, despite the violation of the geometric assumptions. This agreement is especially surprising for a low pycnocline: the discontinuity in the geometry occurs above the pycnocline, where we expect errors associated with geometry to be accentuated. 

\section{Conclusions}\label{S:Discussion}
In this paper, we have presented an asymptotic analysis of the equations describing subglacial plumes~\cite{Jenkins1991JGeophysResOceans, Jenkins2011JPhysOcean} with non-constant basal slopes and two layer ambient stratification. We then constructed an approximation to the melt rate that emerges from numerical solutions of the model equations, which builds upon this analysis. This approximation agrees well with numerical solutions, provided that assumptions on the basal topography are not violated. In addition, we have demonstrated that this approximation improves upon those of~\citet{Lazeroms2019JPhysOcean}, on which the current state of the art two-dimensional melt rate parametrizations are based.

Our asymptotic analysis exploited the small size of several dimensionless parameters; in particular, we exploited the small  basal slopes that are typical for ice shelves in Antarctica, the relative slenderness of the pycnocline, and the relatively weak thermal driving. This analysis revealed the presence of four distinct solution regions, depending on the proximity to the grounding line, the proximity to the pycnocline, and the speed of the plume. The approximation to the melt rate we constructed was similarly split according to these regions, albeit with clear boundaries between them rather than matching conditions as in the asymptotic analysis. Only in the region closest to the grounding line do the corresponding leading order equations have an analytic solution: our approximation to the melt rate has an asymptotically well defined error only in this region. 

Another way to view this is that, in the absence of stratification, or in the case that the pycnocline lies below the grounding line, our approximation to the melt rate has a small, well defined error everywhere.  This was demonstrated by comparison with numerical solutions; the approximation we constructed agrees well for a variety of idealized ice shelf bases, even when the geometric assumptions made were violated. In addition, it performed better than the ~\citet{Lazeroms2019JPhysOcean} approximation, which was attributed to a improved accounting of both local and non-local geometry.

When ambient stratification is imposed on the model, further solution regions must be considered. When stratification is strong, the plume model may predict termination within the pyncocline and only two of the four regions considered are pertinent; our approximation accurately predicted both the depth at which the plume terminates and the behaviour up to this point. This phenomenon is only expected to be seen, however, when stratification is stronger than is expected in Antarctica. With more typical conditions, each of the four regions enters into the solution, and our approximation also showed good agreement with numerical solutions under these conditions. We saw a reasonable deviation, however, when the grounding line is deep and the plume therefore terminates. This was attributed to our construction of the approximation above the pycnocline. We stress again that our approximation in this region is not unique, and merely guided by the leading order behaviour, which could not be determined analytically. 

Finally, we assessed the performance of our approximation in the case that both two-layer ambient stratification and a non-constant basal slope are imposed. Good agreement was seen in cases in which the assumptions on the basal topography were not violated, but this comparison also highlighted the possibility of spurious predictions when these assumptions do not hold.

Our original motivation was to improve two-dimensional parametrizations of melt rates that may be used in future projections of the Antarctic ice sheet. The key challenge, following the analysis presented here, is to extend the constructed approximation to a second spatial dimension. Whilst this is beyond the scope of this paper, it should be noted that this presents a significant challenge. \citet{Lazeroms2018TheCryo} discussed this issue in detail and offered a (non-unique) solution; unfortunately, this method is not immediately applicable to the approximation constructed here since it assumes that the melt rate depends only on the local ice shelf conditions, whereas our approximation requires the history of the plume path to be resolved. Other possible pragmatic issues include our use of an idealized ambient stratification, which is only a first approximation to realistic conditions, and our neglect of subglacial discharge; although the latter is expected to have a negligible influence on the plume dynamics, it may permit a high melt rate near to the grounding line, which has been shown to have a significant influence on the dynamics of the entire ice sheet~\citep{Arthern2017GRL}. There are further practical considerations for the work presented here. Most pressing is the use of one dimensional plume theory: for example, any parametrization that is based on a extension of this theory will not (naturally) include rotation, and will not account for mode two or mode three melting, which are prominent in certain regions of Antarctica~\citep{Adusumilli2020NatureGeo}. The importance of accurate basal melt rates in projections of the Antarctic ice sheets on multi-century timescales provides motivation for the development of parametrizations that address these issues. 



\section{Figures \& Tables}

The output for figure is:\vspace*{-7pt}

\begin{figure}[!h]
%\centering\includegraphics[width=2.5in]{xxxxxx.eps}
%%% where xxxxxx name represents "figurename.eps"
\caption{Insert figure caption here}
\label{fig_sim}
\end{figure}

\vspace*{-5pt}

\noindent The output for table is:\vspace*{-7pt}

\begin{table}[!h]
\caption{An Example of a Table}%%%Table caption goes here
\label{table_example}
\begin{tabular}{llll}%%%The number of columns has to be defined here
\hline
date &Dutch policy &date &European policy \\
\hline
1988 &Memorandum Prevention &1985 &European Directive (85/339) \\
1991--1997 &{\bf Packaging Covenant I} & & \\
1994 &Law Environmental Management &1994 &European Directive (94/62) \\
1997 &Agreement Packaging and Packaging Waste & & \\\hline
\end{tabular}
\vspace*{-4pt}
\end{table}%%%End of the table


\enlargethispage{20pt}

\ethics{Insert ethics text here.}

\dataccess{Insert data access text here.}

\aucontribute{Insert author contribute text here.}

\competing{Insert competing text here.}

\funding{Insert funding text here.}

\ack{Insert acknowledgment text here.}

\disclaimer{Insert disclaimer text here.}

%%%%%%%%%% Insert bibliography here %%%%%%%%%%%%%%
%\bibliographystyle{unsrtnat}
\bibliographystyle{apalike}


\bibliography{mybib.bib}


\end{document}
